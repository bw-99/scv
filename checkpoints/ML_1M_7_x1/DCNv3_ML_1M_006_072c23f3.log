2024-09-23 03:39:09,406 P142781 INFO FuxiCTR version: 2.3.2
2024-09-23 03:39:09,407 P142781 INFO Params: {
    "batch_norm": "True",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "dataset/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "deep_net_dropout": "0.2",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "layer_norm": "True",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DCNv3",
    "model_id": "DCNv3_ML_1M_006_072c23f3",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_regularizer": "0",
    "num_deep_cross_layers": "1",
    "num_heads": "1",
    "num_shallow_cross_layers": "1",
    "num_workers": "4",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shallow_net_dropout": "0.3",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "dataset/ML_1M/test.csv",
    "train_data": "dataset/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "dataset/ML_1M/valid.csv",
    "verbose": "1"
}
2024-09-23 03:39:09,408 P142781 INFO Set up feature processor...
2024-09-23 03:39:09,408 P142781 WARNING Skip rebuilding dataset/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-09-23 03:39:09,408 P142781 INFO Load feature_map from json: dataset/ML_1M_7_x1/feature_map.json
2024-09-23 03:39:09,409 P142781 INFO Set column index...
2024-09-23 03:39:09,409 P142781 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'max_len': 5, 'vocab_size': 302}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 3659}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 83}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 6042}"
}
2024-09-23 03:39:10,721 P142781 INFO Total number of parameters: 175174.
2024-09-23 03:39:10,721 P142781 INFO Loading datasets...
2024-09-23 03:39:12,860 P142781 INFO Train samples: total/700146, blocks/1
2024-09-23 03:39:13,161 P142781 INFO Validation samples: total/200041, blocks/1
2024-09-23 03:39:13,161 P142781 INFO Loading train and validation data done.
2024-09-23 03:39:13,161 P142781 INFO Start training: 171 batches/epoch
2024-09-23 03:39:13,162 P142781 INFO ************ Epoch=1 start ************
2024-09-23 03:39:55,628 P142781 INFO Train loss: 0.454569
2024-09-23 03:39:55,628 P142781 INFO Evaluation @epoch 1 - batch 171: 
2024-09-23 03:39:58,057 P142781 INFO [Metrics] AUC: 0.798674 - logloss: 0.362130
2024-09-23 03:39:58,058 P142781 INFO Save best model: monitor(max)=0.798674
2024-09-23 03:39:58,122 P142781 INFO ************ Epoch=1 end ************
2024-09-23 03:40:39,373 P142781 INFO Train loss: 0.384069
2024-09-23 03:40:39,373 P142781 INFO Evaluation @epoch 2 - batch 171: 
2024-09-23 03:40:41,859 P142781 INFO [Metrics] AUC: 0.809971 - logloss: 0.351725
2024-09-23 03:40:41,860 P142781 INFO Save best model: monitor(max)=0.809971
2024-09-23 03:40:41,927 P142781 INFO ************ Epoch=2 end ************
2024-09-23 03:41:21,236 P142781 INFO Train loss: 0.373180
2024-09-23 03:41:21,236 P142781 INFO Evaluation @epoch 3 - batch 171: 
2024-09-23 03:41:23,433 P142781 INFO [Metrics] AUC: 0.816385 - logloss: 0.346823
2024-09-23 03:41:23,434 P142781 INFO Save best model: monitor(max)=0.816385
2024-09-23 03:41:23,515 P142781 INFO ************ Epoch=3 end ************
2024-09-23 03:42:04,452 P142781 INFO Train loss: 0.368163
2024-09-23 03:42:04,453 P142781 INFO Evaluation @epoch 4 - batch 171: 
2024-09-23 03:42:06,922 P142781 INFO [Metrics] AUC: 0.820745 - logloss: 0.343264
2024-09-23 03:42:06,922 P142781 INFO Save best model: monitor(max)=0.820745
2024-09-23 03:42:07,000 P142781 INFO ************ Epoch=4 end ************
2024-09-23 03:42:48,385 P142781 INFO Train loss: 0.364624
2024-09-23 03:42:48,386 P142781 INFO Evaluation @epoch 5 - batch 171: 
2024-09-23 03:42:50,876 P142781 INFO [Metrics] AUC: 0.823067 - logloss: 0.341278
2024-09-23 03:42:50,876 P142781 INFO Save best model: monitor(max)=0.823067
2024-09-23 03:42:50,949 P142781 INFO ************ Epoch=5 end ************
2024-09-23 03:43:32,690 P142781 INFO Train loss: 0.362748
2024-09-23 03:43:32,691 P142781 INFO Evaluation @epoch 6 - batch 171: 
2024-09-23 03:43:35,278 P142781 INFO [Metrics] AUC: 0.825205 - logloss: 0.339691
2024-09-23 03:43:35,279 P142781 INFO Save best model: monitor(max)=0.825205
2024-09-23 03:43:35,349 P142781 INFO ************ Epoch=6 end ************
2024-09-23 03:44:16,424 P142781 INFO Train loss: 0.361059
2024-09-23 03:44:16,425 P142781 INFO Evaluation @epoch 7 - batch 171: 
2024-09-23 03:44:19,002 P142781 INFO [Metrics] AUC: 0.825953 - logloss: 0.339120
2024-09-23 03:44:19,003 P142781 INFO Save best model: monitor(max)=0.825953
2024-09-23 03:44:19,085 P142781 INFO ************ Epoch=7 end ************
2024-09-23 03:45:00,473 P142781 INFO Train loss: 0.359964
2024-09-23 03:45:00,474 P142781 INFO Evaluation @epoch 8 - batch 171: 
2024-09-23 03:45:03,012 P142781 INFO [Metrics] AUC: 0.827284 - logloss: 0.337967
2024-09-23 03:45:03,012 P142781 INFO Save best model: monitor(max)=0.827284
2024-09-23 03:45:03,111 P142781 INFO ************ Epoch=8 end ************
2024-09-23 03:45:44,579 P142781 INFO Train loss: 0.359324
2024-09-23 03:45:44,579 P142781 INFO Evaluation @epoch 9 - batch 171: 
2024-09-23 03:45:47,067 P142781 INFO [Metrics] AUC: 0.829706 - logloss: 0.336019
2024-09-23 03:45:47,068 P142781 INFO Save best model: monitor(max)=0.829706
2024-09-23 03:45:47,136 P142781 INFO ************ Epoch=9 end ************
2024-09-23 03:46:28,884 P142781 INFO Train loss: 0.358458
2024-09-23 03:46:28,884 P142781 INFO Evaluation @epoch 10 - batch 171: 
2024-09-23 03:46:31,425 P142781 INFO [Metrics] AUC: 0.831237 - logloss: 0.335095
2024-09-23 03:46:31,425 P142781 INFO Save best model: monitor(max)=0.831237
2024-09-23 03:46:31,500 P142781 INFO ************ Epoch=10 end ************
2024-09-23 03:47:08,643 P142781 INFO Train loss: 0.357795
2024-09-23 03:47:08,644 P142781 INFO Evaluation @epoch 11 - batch 171: 
2024-09-23 03:47:11,009 P142781 INFO [Metrics] AUC: 0.831964 - logloss: 0.334547
2024-09-23 03:47:11,010 P142781 INFO Save best model: monitor(max)=0.831964
2024-09-23 03:47:11,081 P142781 INFO ************ Epoch=11 end ************
2024-09-23 03:47:52,961 P142781 INFO Train loss: 0.357107
2024-09-23 03:47:52,961 P142781 INFO Evaluation @epoch 12 - batch 171: 
2024-09-23 03:47:55,539 P142781 INFO [Metrics] AUC: 0.833711 - logloss: 0.333042
2024-09-23 03:47:55,540 P142781 INFO Save best model: monitor(max)=0.833711
2024-09-23 03:47:55,625 P142781 INFO ************ Epoch=12 end ************
2024-09-23 03:48:37,606 P142781 INFO Train loss: 0.356373
2024-09-23 03:48:37,607 P142781 INFO Evaluation @epoch 13 - batch 171: 
2024-09-23 03:48:40,077 P142781 INFO [Metrics] AUC: 0.834606 - logloss: 0.332156
2024-09-23 03:48:40,078 P142781 INFO Save best model: monitor(max)=0.834606
2024-09-23 03:48:40,161 P142781 INFO ************ Epoch=13 end ************
2024-09-23 03:49:21,718 P142781 INFO Train loss: 0.355832
2024-09-23 03:49:21,719 P142781 INFO Evaluation @epoch 14 - batch 171: 
2024-09-23 03:49:24,301 P142781 INFO [Metrics] AUC: 0.835507 - logloss: 0.331982
2024-09-23 03:49:24,302 P142781 INFO Save best model: monitor(max)=0.835507
2024-09-23 03:49:24,386 P142781 INFO ************ Epoch=14 end ************
2024-09-23 03:50:05,869 P142781 INFO Train loss: 0.354542
2024-09-23 03:50:05,870 P142781 INFO Evaluation @epoch 15 - batch 171: 
2024-09-23 03:50:08,419 P142781 INFO [Metrics] AUC: 0.836769 - logloss: 0.330563
2024-09-23 03:50:08,420 P142781 INFO Save best model: monitor(max)=0.836769
2024-09-23 03:50:08,502 P142781 INFO ************ Epoch=15 end ************
2024-09-23 03:50:49,891 P142781 INFO Train loss: 0.353830
2024-09-23 03:50:49,892 P142781 INFO Evaluation @epoch 16 - batch 171: 
2024-09-23 03:50:52,333 P142781 INFO [Metrics] AUC: 0.836785 - logloss: 0.330697
2024-09-23 03:50:52,334 P142781 INFO Save best model: monitor(max)=0.836785
2024-09-23 03:50:52,398 P142781 INFO ************ Epoch=16 end ************
2024-09-23 03:51:34,658 P142781 INFO Train loss: 0.353343
2024-09-23 03:51:34,658 P142781 INFO Evaluation @epoch 17 - batch 171: 
2024-09-23 03:51:37,188 P142781 INFO [Metrics] AUC: 0.839060 - logloss: 0.329027
2024-09-23 03:51:37,189 P142781 INFO Save best model: monitor(max)=0.839060
2024-09-23 03:51:37,267 P142781 INFO ************ Epoch=17 end ************
2024-09-23 03:52:18,143 P142781 INFO Train loss: 0.352440
2024-09-23 03:52:18,144 P142781 INFO Evaluation @epoch 18 - batch 171: 
2024-09-23 03:52:20,742 P142781 INFO [Metrics] AUC: 0.838614 - logloss: 0.329633
2024-09-23 03:52:20,743 P142781 INFO Monitor(max)=0.838614 STOP!
2024-09-23 03:52:20,743 P142781 INFO Reduce learning rate on plateau: 0.000100
2024-09-23 03:52:20,824 P142781 INFO ************ Epoch=18 end ************
2024-09-23 03:53:02,812 P142781 INFO Train loss: 0.332297
2024-09-23 03:53:02,813 P142781 INFO Evaluation @epoch 19 - batch 171: 
2024-09-23 03:53:05,393 P142781 INFO [Metrics] AUC: 0.846842 - logloss: 0.322434
2024-09-23 03:53:05,394 P142781 INFO Save best model: monitor(max)=0.846842
2024-09-23 03:53:05,466 P142781 INFO ************ Epoch=19 end ************
2024-09-23 03:53:47,352 P142781 INFO Train loss: 0.322904
2024-09-23 03:53:47,353 P142781 INFO Evaluation @epoch 20 - batch 171: 
2024-09-23 03:53:49,847 P142781 INFO [Metrics] AUC: 0.849614 - logloss: 0.320294
2024-09-23 03:53:49,848 P142781 INFO Save best model: monitor(max)=0.849614
2024-09-23 03:53:49,929 P142781 INFO ************ Epoch=20 end ************
2024-09-23 03:54:30,752 P142781 INFO Train loss: 0.318579
2024-09-23 03:54:30,753 P142781 INFO Evaluation @epoch 21 - batch 171: 
2024-09-23 03:54:33,310 P142781 INFO [Metrics] AUC: 0.850642 - logloss: 0.319459
2024-09-23 03:54:33,310 P142781 INFO Save best model: monitor(max)=0.850642
2024-09-23 03:54:33,388 P142781 INFO ************ Epoch=21 end ************
2024-09-23 03:55:15,057 P142781 INFO Train loss: 0.316085
2024-09-23 03:55:15,058 P142781 INFO Evaluation @epoch 22 - batch 171: 
2024-09-23 03:55:17,539 P142781 INFO [Metrics] AUC: 0.851175 - logloss: 0.319057
2024-09-23 03:55:17,539 P142781 INFO Save best model: monitor(max)=0.851175
2024-09-23 03:55:17,612 P142781 INFO ************ Epoch=22 end ************
2024-09-23 03:55:56,377 P142781 INFO Train loss: 0.314248
2024-09-23 03:55:56,377 P142781 INFO Evaluation @epoch 23 - batch 171: 
2024-09-23 03:55:58,564 P142781 INFO [Metrics] AUC: 0.851490 - logloss: 0.318945
2024-09-23 03:55:58,565 P142781 INFO Save best model: monitor(max)=0.851490
2024-09-23 03:55:58,638 P142781 INFO ************ Epoch=23 end ************
2024-09-23 03:56:40,144 P142781 INFO Train loss: 0.312500
2024-09-23 03:56:40,145 P142781 INFO Evaluation @epoch 24 - batch 171: 
2024-09-23 03:56:42,607 P142781 INFO [Metrics] AUC: 0.851648 - logloss: 0.318864
2024-09-23 03:56:42,607 P142781 INFO Save best model: monitor(max)=0.851648
2024-09-23 03:56:42,685 P142781 INFO ************ Epoch=24 end ************
2024-09-23 03:57:24,503 P142781 INFO Train loss: 0.311088
2024-09-23 03:57:24,504 P142781 INFO Evaluation @epoch 25 - batch 171: 
2024-09-23 03:57:26,995 P142781 INFO [Metrics] AUC: 0.851861 - logloss: 0.318625
2024-09-23 03:57:26,996 P142781 INFO Save best model: monitor(max)=0.851861
2024-09-23 03:57:27,074 P142781 INFO ************ Epoch=25 end ************
2024-09-23 03:58:08,361 P142781 INFO Train loss: 0.309735
2024-09-23 03:58:08,361 P142781 INFO Evaluation @epoch 26 - batch 171: 
2024-09-23 03:58:10,901 P142781 INFO [Metrics] AUC: 0.851844 - logloss: 0.318682
2024-09-23 03:58:10,902 P142781 INFO Monitor(max)=0.851844 STOP!
2024-09-23 03:58:10,902 P142781 INFO Reduce learning rate on plateau: 0.000010
2024-09-23 03:58:10,970 P142781 INFO ************ Epoch=26 end ************
2024-09-23 03:58:53,269 P142781 INFO Train loss: 0.302489
2024-09-23 03:58:53,269 P142781 INFO Evaluation @epoch 27 - batch 171: 
2024-09-23 03:58:55,762 P142781 INFO [Metrics] AUC: 0.851966 - logloss: 0.319005
2024-09-23 03:58:55,763 P142781 INFO Save best model: monitor(max)=0.851966
2024-09-23 03:58:55,846 P142781 INFO ************ Epoch=27 end ************
2024-09-23 03:59:36,855 P142781 INFO Train loss: 0.301989
2024-09-23 03:59:36,855 P142781 INFO Evaluation @epoch 28 - batch 171: 
2024-09-23 03:59:39,322 P142781 INFO [Metrics] AUC: 0.851991 - logloss: 0.319049
2024-09-23 03:59:39,323 P142781 INFO Save best model: monitor(max)=0.851991
2024-09-23 03:59:39,399 P142781 INFO ************ Epoch=28 end ************
2024-09-23 04:00:20,994 P142781 INFO Train loss: 0.301369
2024-09-23 04:00:20,995 P142781 INFO Evaluation @epoch 29 - batch 171: 
2024-09-23 04:00:23,573 P142781 INFO [Metrics] AUC: 0.852002 - logloss: 0.319135
2024-09-23 04:00:23,574 P142781 INFO Save best model: monitor(max)=0.852002
2024-09-23 04:00:23,650 P142781 INFO ************ Epoch=29 end ************
2024-09-23 04:01:05,661 P142781 INFO Train loss: 0.301240
2024-09-23 04:01:05,662 P142781 INFO Evaluation @epoch 30 - batch 171: 
2024-09-23 04:01:08,231 P142781 INFO [Metrics] AUC: 0.852033 - logloss: 0.319165
2024-09-23 04:01:08,232 P142781 INFO Save best model: monitor(max)=0.852033
2024-09-23 04:01:08,332 P142781 INFO ************ Epoch=30 end ************
2024-09-23 04:01:50,080 P142781 INFO Train loss: 0.300931
2024-09-23 04:01:50,081 P142781 INFO Evaluation @epoch 31 - batch 171: 
2024-09-23 04:01:52,563 P142781 INFO [Metrics] AUC: 0.852029 - logloss: 0.319102
2024-09-23 04:01:52,563 P142781 INFO Monitor(max)=0.852029 STOP!
2024-09-23 04:01:52,563 P142781 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 04:01:52,628 P142781 INFO ************ Epoch=31 end ************
2024-09-23 04:02:34,856 P142781 INFO Train loss: 0.299921
2024-09-23 04:02:34,856 P142781 INFO Evaluation @epoch 32 - batch 171: 
2024-09-23 04:02:37,407 P142781 INFO [Metrics] AUC: 0.852031 - logloss: 0.319130
2024-09-23 04:02:37,408 P142781 INFO Monitor(max)=0.852031 STOP!
2024-09-23 04:02:37,408 P142781 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 04:02:37,408 P142781 INFO ********* Epoch=32 early stop *********
2024-09-23 04:02:37,483 P142781 INFO Training finished.
2024-09-23 04:02:37,483 P142781 INFO Load best model: /workspace/checkpoints/ML_1M_7_x1/DCNv3_ML_1M_006_072c23f3.model
2024-09-23 04:02:37,505 P142781 INFO ****** Validation evaluation ******
2024-09-23 04:02:39,893 P142781 INFO [Metrics] logloss: 0.319165 - AUC: 0.852033
2024-09-23 04:02:40,089 P142781 INFO ******** Test evaluation ********
2024-09-23 04:02:40,090 P142781 INFO Loading datasets...
2024-09-23 04:02:40,413 P142781 INFO Test samples: total/100022, blocks/1
2024-09-23 04:02:40,414 P142781 INFO Loading test data done.
2024-09-23 04:02:41,892 P142781 INFO [Metrics] logloss: 0.317845 - AUC: 0.852162
