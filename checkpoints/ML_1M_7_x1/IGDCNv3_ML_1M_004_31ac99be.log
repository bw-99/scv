2024-09-23 21:21:37,228 P348070 INFO FuxiCTR version: 2.3.2
2024-09-23 21:21:37,228 P348070 INFO Params: {
    "batch_norm": "True",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "dataset/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "deep_net_dropout": "0.2",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "layer_norm": "True",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "IGDCNv3",
    "model_id": "IGDCNv3_ML_1M_004_31ac99be",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_regularizer": "0",
    "num_deep_cross_layers": "1",
    "num_heads": "1",
    "num_shallow_cross_layers": "1",
    "num_workers": "4",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shallow_net_dropout": "0.1",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "dataset/ML_1M/test.csv",
    "train_data": "dataset/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "dataset/ML_1M/valid.csv",
    "verbose": "1"
}
2024-09-23 21:21:37,229 P348070 INFO Set up feature processor...
2024-09-23 21:21:37,230 P348070 WARNING Skip rebuilding dataset/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-09-23 21:21:37,230 P348070 INFO Load feature_map from json: dataset/ML_1M_7_x1/feature_map.json
2024-09-23 21:21:37,230 P348070 INFO Set column index...
2024-09-23 21:21:37,230 P348070 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'max_len': 5, 'vocab_size': 302}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 3659}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 83}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 6042}"
}
2024-09-23 21:21:38,432 P348070 INFO Total number of parameters: 175286.
2024-09-23 21:21:38,433 P348070 INFO Loading datasets...
2024-09-23 21:21:40,017 P348070 INFO Train samples: total/700146, blocks/1
2024-09-23 21:21:40,466 P348070 INFO Validation samples: total/200041, blocks/1
2024-09-23 21:21:40,467 P348070 INFO Loading train and validation data done.
2024-09-23 21:21:40,467 P348070 INFO Start training: 171 batches/epoch
2024-09-23 21:21:40,467 P348070 INFO ************ Epoch=1 start ************
2024-09-23 21:21:45,380 P348070 INFO Train loss: 0.464314
2024-09-23 21:21:45,380 P348070 INFO Evaluation @epoch 1 - batch 171: 
2024-09-23 21:21:46,130 P348070 INFO [Metrics] AUC: 0.800479 - logloss: 0.358755
2024-09-23 21:21:46,130 P348070 INFO Save best model: monitor(max)=0.800479
2024-09-23 21:21:46,174 P348070 INFO ************ Epoch=1 end ************
2024-09-23 21:21:50,124 P348070 INFO Train loss: 0.384089
2024-09-23 21:21:50,124 P348070 INFO Evaluation @epoch 2 - batch 171: 
2024-09-23 21:21:50,844 P348070 INFO [Metrics] AUC: 0.805073 - logloss: 0.355885
2024-09-23 21:21:50,845 P348070 INFO Save best model: monitor(max)=0.805073
2024-09-23 21:21:50,902 P348070 INFO ************ Epoch=2 end ************
2024-09-23 21:21:54,841 P348070 INFO Train loss: 0.374488
2024-09-23 21:21:54,841 P348070 INFO Evaluation @epoch 3 - batch 171: 
2024-09-23 21:21:55,576 P348070 INFO [Metrics] AUC: 0.809637 - logloss: 0.351964
2024-09-23 21:21:55,577 P348070 INFO Save best model: monitor(max)=0.809637
2024-09-23 21:21:55,633 P348070 INFO ************ Epoch=3 end ************
2024-09-23 21:21:59,561 P348070 INFO Train loss: 0.369403
2024-09-23 21:21:59,561 P348070 INFO Evaluation @epoch 4 - batch 171: 
2024-09-23 21:22:00,297 P348070 INFO [Metrics] AUC: 0.811581 - logloss: 0.350231
2024-09-23 21:22:00,298 P348070 INFO Save best model: monitor(max)=0.811581
2024-09-23 21:22:00,359 P348070 INFO ************ Epoch=4 end ************
2024-09-23 21:22:04,248 P348070 INFO Train loss: 0.365865
2024-09-23 21:22:04,248 P348070 INFO Evaluation @epoch 5 - batch 171: 
2024-09-23 21:22:04,976 P348070 INFO [Metrics] AUC: 0.815581 - logloss: 0.347481
2024-09-23 21:22:04,976 P348070 INFO Save best model: monitor(max)=0.815581
2024-09-23 21:22:05,033 P348070 INFO ************ Epoch=5 end ************
2024-09-23 21:22:09,061 P348070 INFO Train loss: 0.362715
2024-09-23 21:22:09,061 P348070 INFO Evaluation @epoch 6 - batch 171: 
2024-09-23 21:22:09,796 P348070 INFO [Metrics] AUC: 0.816743 - logloss: 0.346733
2024-09-23 21:22:09,797 P348070 INFO Save best model: monitor(max)=0.816743
2024-09-23 21:22:09,853 P348070 INFO ************ Epoch=6 end ************
2024-09-23 21:22:13,864 P348070 INFO Train loss: 0.360449
2024-09-23 21:22:13,864 P348070 INFO Evaluation @epoch 7 - batch 171: 
2024-09-23 21:22:14,591 P348070 INFO [Metrics] AUC: 0.816758 - logloss: 0.346880
2024-09-23 21:22:14,592 P348070 INFO Save best model: monitor(max)=0.816758
2024-09-23 21:22:14,647 P348070 INFO ************ Epoch=7 end ************
2024-09-23 21:22:18,547 P348070 INFO Train loss: 0.358677
2024-09-23 21:22:18,548 P348070 INFO Evaluation @epoch 8 - batch 171: 
2024-09-23 21:22:19,279 P348070 INFO [Metrics] AUC: 0.818515 - logloss: 0.345377
2024-09-23 21:22:19,280 P348070 INFO Save best model: monitor(max)=0.818515
2024-09-23 21:22:19,337 P348070 INFO ************ Epoch=8 end ************
2024-09-23 21:22:23,231 P348070 INFO Train loss: 0.357427
2024-09-23 21:22:23,231 P348070 INFO Evaluation @epoch 9 - batch 171: 
2024-09-23 21:22:23,958 P348070 INFO [Metrics] AUC: 0.820531 - logloss: 0.344101
2024-09-23 21:22:23,958 P348070 INFO Save best model: monitor(max)=0.820531
2024-09-23 21:22:24,013 P348070 INFO ************ Epoch=9 end ************
2024-09-23 21:22:28,019 P348070 INFO Train loss: 0.356938
2024-09-23 21:22:28,020 P348070 INFO Evaluation @epoch 10 - batch 171: 
2024-09-23 21:22:28,759 P348070 INFO [Metrics] AUC: 0.821504 - logloss: 0.342906
2024-09-23 21:22:28,760 P348070 INFO Save best model: monitor(max)=0.821504
2024-09-23 21:22:28,819 P348070 INFO ************ Epoch=10 end ************
2024-09-23 21:22:32,775 P348070 INFO Train loss: 0.356284
2024-09-23 21:22:32,776 P348070 INFO Evaluation @epoch 11 - batch 171: 
2024-09-23 21:22:33,501 P348070 INFO [Metrics] AUC: 0.823953 - logloss: 0.341160
2024-09-23 21:22:33,502 P348070 INFO Save best model: monitor(max)=0.823953
2024-09-23 21:22:33,557 P348070 INFO ************ Epoch=11 end ************
2024-09-23 21:22:37,488 P348070 INFO Train loss: 0.355895
2024-09-23 21:22:37,488 P348070 INFO Evaluation @epoch 12 - batch 171: 
2024-09-23 21:22:38,199 P348070 INFO [Metrics] AUC: 0.826673 - logloss: 0.338613
2024-09-23 21:22:38,200 P348070 INFO Save best model: monitor(max)=0.826673
2024-09-23 21:22:38,254 P348070 INFO ************ Epoch=12 end ************
2024-09-23 21:22:42,141 P348070 INFO Train loss: 0.356069
2024-09-23 21:22:42,142 P348070 INFO Evaluation @epoch 13 - batch 171: 
2024-09-23 21:22:42,848 P348070 INFO [Metrics] AUC: 0.828212 - logloss: 0.337559
2024-09-23 21:22:42,849 P348070 INFO Save best model: monitor(max)=0.828212
2024-09-23 21:22:42,905 P348070 INFO ************ Epoch=13 end ************
2024-09-23 21:22:46,737 P348070 INFO Train loss: 0.354979
2024-09-23 21:22:46,737 P348070 INFO Evaluation @epoch 14 - batch 171: 
2024-09-23 21:22:47,457 P348070 INFO [Metrics] AUC: 0.830812 - logloss: 0.335771
2024-09-23 21:22:47,458 P348070 INFO Save best model: monitor(max)=0.830812
2024-09-23 21:22:47,512 P348070 INFO ************ Epoch=14 end ************
2024-09-23 21:22:51,387 P348070 INFO Train loss: 0.354517
2024-09-23 21:22:51,387 P348070 INFO Evaluation @epoch 15 - batch 171: 
2024-09-23 21:22:52,104 P348070 INFO [Metrics] AUC: 0.832655 - logloss: 0.334028
2024-09-23 21:22:52,105 P348070 INFO Save best model: monitor(max)=0.832655
2024-09-23 21:22:52,167 P348070 INFO ************ Epoch=15 end ************
2024-09-23 21:22:56,061 P348070 INFO Train loss: 0.353777
2024-09-23 21:22:56,061 P348070 INFO Evaluation @epoch 16 - batch 171: 
2024-09-23 21:22:56,784 P348070 INFO [Metrics] AUC: 0.833460 - logloss: 0.333231
2024-09-23 21:22:56,785 P348070 INFO Save best model: monitor(max)=0.833460
2024-09-23 21:22:56,840 P348070 INFO ************ Epoch=16 end ************
2024-09-23 21:23:00,852 P348070 INFO Train loss: 0.353317
2024-09-23 21:23:00,852 P348070 INFO Evaluation @epoch 17 - batch 171: 
2024-09-23 21:23:01,577 P348070 INFO [Metrics] AUC: 0.835629 - logloss: 0.331929
2024-09-23 21:23:01,578 P348070 INFO Save best model: monitor(max)=0.835629
2024-09-23 21:23:01,634 P348070 INFO ************ Epoch=17 end ************
2024-09-23 21:23:05,519 P348070 INFO Train loss: 0.352382
2024-09-23 21:23:05,519 P348070 INFO Evaluation @epoch 18 - batch 171: 
2024-09-23 21:23:06,228 P348070 INFO [Metrics] AUC: 0.836005 - logloss: 0.331198
2024-09-23 21:23:06,229 P348070 INFO Save best model: monitor(max)=0.836005
2024-09-23 21:23:06,287 P348070 INFO ************ Epoch=18 end ************
2024-09-23 21:23:10,361 P348070 INFO Train loss: 0.351832
2024-09-23 21:23:10,362 P348070 INFO Evaluation @epoch 19 - batch 171: 
2024-09-23 21:23:11,073 P348070 INFO [Metrics] AUC: 0.835571 - logloss: 0.331389
2024-09-23 21:23:11,074 P348070 INFO Monitor(max)=0.835571 STOP!
2024-09-23 21:23:11,074 P348070 INFO Reduce learning rate on plateau: 0.000100
2024-09-23 21:23:11,124 P348070 INFO ************ Epoch=19 end ************
2024-09-23 21:23:15,085 P348070 INFO Train loss: 0.333189
2024-09-23 21:23:15,086 P348070 INFO Evaluation @epoch 20 - batch 171: 
2024-09-23 21:23:15,829 P348070 INFO [Metrics] AUC: 0.843217 - logloss: 0.325130
2024-09-23 21:23:15,830 P348070 INFO Save best model: monitor(max)=0.843217
2024-09-23 21:23:15,886 P348070 INFO ************ Epoch=20 end ************
2024-09-23 21:23:19,960 P348070 INFO Train loss: 0.325149
2024-09-23 21:23:19,961 P348070 INFO Evaluation @epoch 21 - batch 171: 
2024-09-23 21:23:20,688 P348070 INFO [Metrics] AUC: 0.846011 - logloss: 0.322866
2024-09-23 21:23:20,689 P348070 INFO Save best model: monitor(max)=0.846011
2024-09-23 21:23:20,753 P348070 INFO ************ Epoch=21 end ************
2024-09-23 21:23:24,863 P348070 INFO Train loss: 0.321685
2024-09-23 21:23:24,863 P348070 INFO Evaluation @epoch 22 - batch 171: 
2024-09-23 21:23:25,599 P348070 INFO [Metrics] AUC: 0.847274 - logloss: 0.321934
2024-09-23 21:23:25,599 P348070 INFO Save best model: monitor(max)=0.847274
2024-09-23 21:23:25,656 P348070 INFO ************ Epoch=22 end ************
2024-09-23 21:23:29,800 P348070 INFO Train loss: 0.319509
2024-09-23 21:23:29,800 P348070 INFO Evaluation @epoch 23 - batch 171: 
2024-09-23 21:23:30,520 P348070 INFO [Metrics] AUC: 0.848246 - logloss: 0.321244
2024-09-23 21:23:30,521 P348070 INFO Save best model: monitor(max)=0.848246
2024-09-23 21:23:30,577 P348070 INFO ************ Epoch=23 end ************
2024-09-23 21:23:34,541 P348070 INFO Train loss: 0.317959
2024-09-23 21:23:34,541 P348070 INFO Evaluation @epoch 24 - batch 171: 
2024-09-23 21:23:35,265 P348070 INFO [Metrics] AUC: 0.848530 - logloss: 0.320950
2024-09-23 21:23:35,266 P348070 INFO Save best model: monitor(max)=0.848530
2024-09-23 21:23:35,322 P348070 INFO ************ Epoch=24 end ************
2024-09-23 21:23:39,237 P348070 INFO Train loss: 0.316718
2024-09-23 21:23:39,237 P348070 INFO Evaluation @epoch 25 - batch 171: 
2024-09-23 21:23:39,975 P348070 INFO [Metrics] AUC: 0.848763 - logloss: 0.320870
2024-09-23 21:23:39,975 P348070 INFO Save best model: monitor(max)=0.848763
2024-09-23 21:23:40,032 P348070 INFO ************ Epoch=25 end ************
2024-09-23 21:23:44,073 P348070 INFO Train loss: 0.315615
2024-09-23 21:23:44,073 P348070 INFO Evaluation @epoch 26 - batch 171: 
2024-09-23 21:23:44,787 P348070 INFO [Metrics] AUC: 0.848819 - logloss: 0.320776
2024-09-23 21:23:44,788 P348070 INFO Save best model: monitor(max)=0.848819
2024-09-23 21:23:44,843 P348070 INFO ************ Epoch=26 end ************
2024-09-23 21:23:48,926 P348070 INFO Train loss: 0.314502
2024-09-23 21:23:48,926 P348070 INFO Evaluation @epoch 27 - batch 171: 
2024-09-23 21:23:49,662 P348070 INFO [Metrics] AUC: 0.849191 - logloss: 0.320591
2024-09-23 21:23:49,662 P348070 INFO Save best model: monitor(max)=0.849191
2024-09-23 21:23:49,717 P348070 INFO ************ Epoch=27 end ************
2024-09-23 21:23:53,869 P348070 INFO Train loss: 0.313513
2024-09-23 21:23:53,870 P348070 INFO Evaluation @epoch 28 - batch 171: 
2024-09-23 21:23:54,610 P348070 INFO [Metrics] AUC: 0.849506 - logloss: 0.320336
2024-09-23 21:23:54,611 P348070 INFO Save best model: monitor(max)=0.849506
2024-09-23 21:23:54,667 P348070 INFO ************ Epoch=28 end ************
2024-09-23 21:23:58,563 P348070 INFO Train loss: 0.312722
2024-09-23 21:23:58,563 P348070 INFO Evaluation @epoch 29 - batch 171: 
2024-09-23 21:23:59,255 P348070 INFO [Metrics] AUC: 0.849449 - logloss: 0.320352
2024-09-23 21:23:59,256 P348070 INFO Monitor(max)=0.849449 STOP!
2024-09-23 21:23:59,256 P348070 INFO Reduce learning rate on plateau: 0.000010
2024-09-23 21:23:59,307 P348070 INFO ************ Epoch=29 end ************
2024-09-23 21:24:03,230 P348070 INFO Train loss: 0.305992
2024-09-23 21:24:03,230 P348070 INFO Evaluation @epoch 30 - batch 171: 
2024-09-23 21:24:03,933 P348070 INFO [Metrics] AUC: 0.849604 - logloss: 0.320339
2024-09-23 21:24:03,934 P348070 INFO Save best model: monitor(max)=0.849604
2024-09-23 21:24:03,990 P348070 INFO ************ Epoch=30 end ************
2024-09-23 21:24:07,890 P348070 INFO Train loss: 0.305803
2024-09-23 21:24:07,890 P348070 INFO Evaluation @epoch 31 - batch 171: 
2024-09-23 21:24:08,577 P348070 INFO [Metrics] AUC: 0.849682 - logloss: 0.320329
2024-09-23 21:24:08,577 P348070 INFO Save best model: monitor(max)=0.849682
2024-09-23 21:24:08,632 P348070 INFO ************ Epoch=31 end ************
2024-09-23 21:24:12,550 P348070 INFO Train loss: 0.305375
2024-09-23 21:24:12,550 P348070 INFO Evaluation @epoch 32 - batch 171: 
2024-09-23 21:24:13,233 P348070 INFO [Metrics] AUC: 0.849683 - logloss: 0.320326
2024-09-23 21:24:13,234 P348070 INFO Save best model: monitor(max)=0.849683
2024-09-23 21:24:13,289 P348070 INFO ************ Epoch=32 end ************
2024-09-23 21:24:17,118 P348070 INFO Train loss: 0.305320
2024-09-23 21:24:17,118 P348070 INFO Evaluation @epoch 33 - batch 171: 
2024-09-23 21:24:17,800 P348070 INFO [Metrics] AUC: 0.849716 - logloss: 0.320339
2024-09-23 21:24:17,801 P348070 INFO Save best model: monitor(max)=0.849716
2024-09-23 21:24:17,857 P348070 INFO ************ Epoch=33 end ************
2024-09-23 21:24:21,795 P348070 INFO Train loss: 0.304907
2024-09-23 21:24:21,795 P348070 INFO Evaluation @epoch 34 - batch 171: 
2024-09-23 21:24:22,506 P348070 INFO [Metrics] AUC: 0.849735 - logloss: 0.320324
2024-09-23 21:24:22,507 P348070 INFO Save best model: monitor(max)=0.849735
2024-09-23 21:24:22,564 P348070 INFO ************ Epoch=34 end ************
2024-09-23 21:24:26,545 P348070 INFO Train loss: 0.304800
2024-09-23 21:24:26,546 P348070 INFO Evaluation @epoch 35 - batch 171: 
2024-09-23 21:24:27,251 P348070 INFO [Metrics] AUC: 0.849736 - logloss: 0.320336
2024-09-23 21:24:27,252 P348070 INFO Monitor(max)=0.849736 STOP!
2024-09-23 21:24:27,252 P348070 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 21:24:27,301 P348070 INFO ************ Epoch=35 end ************
2024-09-23 21:24:31,304 P348070 INFO Train loss: 0.303987
2024-09-23 21:24:31,304 P348070 INFO Evaluation @epoch 36 - batch 171: 
2024-09-23 21:24:32,013 P348070 INFO [Metrics] AUC: 0.849736 - logloss: 0.320367
2024-09-23 21:24:32,014 P348070 INFO Monitor(max)=0.849736 STOP!
2024-09-23 21:24:32,014 P348070 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 21:24:32,014 P348070 INFO ********* Epoch=36 early stop *********
2024-09-23 21:24:32,064 P348070 INFO Training finished.
2024-09-23 21:24:32,064 P348070 INFO Load best model: /workspace/checkpoints/ML_1M_7_x1/IGDCNv3_ML_1M_004_31ac99be.model
2024-09-23 21:24:32,069 P348070 INFO ****** Validation evaluation ******
2024-09-23 21:24:32,796 P348070 INFO [Metrics] logloss: 0.320324 - AUC: 0.849735
2024-09-23 21:24:32,919 P348070 INFO ******** Test evaluation ********
2024-09-23 21:24:32,919 P348070 INFO Loading datasets...
2024-09-23 21:24:33,131 P348070 INFO Test samples: total/100022, blocks/1
2024-09-23 21:24:33,132 P348070 INFO Loading test data done.
2024-09-23 21:24:33,600 P348070 INFO [Metrics] logloss: 0.319191 - AUC: 0.849827
