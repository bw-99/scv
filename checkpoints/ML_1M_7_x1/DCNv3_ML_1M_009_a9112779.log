2024-09-23 04:49:04,949 P167296 INFO FuxiCTR version: 2.3.2
2024-09-23 04:49:04,949 P167296 INFO Params: {
    "batch_norm": "True",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "dataset/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "deep_net_dropout": "0.3",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "layer_norm": "True",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DCNv3",
    "model_id": "DCNv3_ML_1M_009_a9112779",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_regularizer": "0",
    "num_deep_cross_layers": "1",
    "num_heads": "1",
    "num_shallow_cross_layers": "1",
    "num_workers": "4",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shallow_net_dropout": "0.3",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "dataset/ML_1M/test.csv",
    "train_data": "dataset/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "dataset/ML_1M/valid.csv",
    "verbose": "1"
}
2024-09-23 04:49:04,950 P167296 INFO Set up feature processor...
2024-09-23 04:49:04,950 P167296 WARNING Skip rebuilding dataset/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-09-23 04:49:04,951 P167296 INFO Load feature_map from json: dataset/ML_1M_7_x1/feature_map.json
2024-09-23 04:49:04,951 P167296 INFO Set column index...
2024-09-23 04:49:04,951 P167296 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'max_len': 5, 'vocab_size': 302}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 3659}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 83}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 6042}"
}
2024-09-23 04:49:06,314 P167296 INFO Total number of parameters: 175174.
2024-09-23 04:49:06,315 P167296 INFO Loading datasets...
2024-09-23 04:49:08,446 P167296 INFO Train samples: total/700146, blocks/1
2024-09-23 04:49:08,809 P167296 INFO Validation samples: total/200041, blocks/1
2024-09-23 04:49:08,810 P167296 INFO Loading train and validation data done.
2024-09-23 04:49:08,810 P167296 INFO Start training: 171 batches/epoch
2024-09-23 04:49:08,810 P167296 INFO ************ Epoch=1 start ************
2024-09-23 04:49:51,391 P167296 INFO Train loss: 0.456076
2024-09-23 04:49:51,392 P167296 INFO Evaluation @epoch 1 - batch 171: 
2024-09-23 04:49:53,866 P167296 INFO [Metrics] AUC: 0.797635 - logloss: 0.362961
2024-09-23 04:49:53,867 P167296 INFO Save best model: monitor(max)=0.797635
2024-09-23 04:49:53,922 P167296 INFO ************ Epoch=1 end ************
2024-09-23 04:50:34,935 P167296 INFO Train loss: 0.385551
2024-09-23 04:50:34,936 P167296 INFO Evaluation @epoch 2 - batch 171: 
2024-09-23 04:50:37,456 P167296 INFO [Metrics] AUC: 0.809480 - logloss: 0.351868
2024-09-23 04:50:37,456 P167296 INFO Save best model: monitor(max)=0.809480
2024-09-23 04:50:37,525 P167296 INFO ************ Epoch=2 end ************
2024-09-23 04:51:19,755 P167296 INFO Train loss: 0.373923
2024-09-23 04:51:19,755 P167296 INFO Evaluation @epoch 3 - batch 171: 
2024-09-23 04:51:22,290 P167296 INFO [Metrics] AUC: 0.816139 - logloss: 0.346861
2024-09-23 04:51:22,290 P167296 INFO Save best model: monitor(max)=0.816139
2024-09-23 04:51:22,370 P167296 INFO ************ Epoch=3 end ************
2024-09-23 04:51:59,441 P167296 INFO Train loss: 0.368445
2024-09-23 04:51:59,442 P167296 INFO Evaluation @epoch 4 - batch 171: 
2024-09-23 04:52:02,036 P167296 INFO [Metrics] AUC: 0.820396 - logloss: 0.343276
2024-09-23 04:52:02,037 P167296 INFO Save best model: monitor(max)=0.820396
2024-09-23 04:52:02,117 P167296 INFO ************ Epoch=4 end ************
2024-09-23 04:52:43,602 P167296 INFO Train loss: 0.364210
2024-09-23 04:52:43,602 P167296 INFO Evaluation @epoch 5 - batch 171: 
2024-09-23 04:52:46,123 P167296 INFO [Metrics] AUC: 0.822669 - logloss: 0.341587
2024-09-23 04:52:46,124 P167296 INFO Save best model: monitor(max)=0.822669
2024-09-23 04:52:46,211 P167296 INFO ************ Epoch=5 end ************
2024-09-23 04:53:28,342 P167296 INFO Train loss: 0.361966
2024-09-23 04:53:28,342 P167296 INFO Evaluation @epoch 6 - batch 171: 
2024-09-23 04:53:30,844 P167296 INFO [Metrics] AUC: 0.825001 - logloss: 0.339707
2024-09-23 04:53:30,844 P167296 INFO Save best model: monitor(max)=0.825001
2024-09-23 04:53:30,917 P167296 INFO ************ Epoch=6 end ************
2024-09-23 04:54:12,491 P167296 INFO Train loss: 0.360472
2024-09-23 04:54:12,491 P167296 INFO Evaluation @epoch 7 - batch 171: 
2024-09-23 04:54:15,026 P167296 INFO [Metrics] AUC: 0.826454 - logloss: 0.338694
2024-09-23 04:54:15,027 P167296 INFO Save best model: monitor(max)=0.826454
2024-09-23 04:54:15,111 P167296 INFO ************ Epoch=7 end ************
2024-09-23 04:54:56,010 P167296 INFO Train loss: 0.359165
2024-09-23 04:54:56,011 P167296 INFO Evaluation @epoch 8 - batch 171: 
2024-09-23 04:54:58,327 P167296 INFO [Metrics] AUC: 0.827704 - logloss: 0.337602
2024-09-23 04:54:58,327 P167296 INFO Save best model: monitor(max)=0.827704
2024-09-23 04:54:58,406 P167296 INFO ************ Epoch=8 end ************
2024-09-23 04:55:40,673 P167296 INFO Train loss: 0.358404
2024-09-23 04:55:40,674 P167296 INFO Evaluation @epoch 9 - batch 171: 
2024-09-23 04:55:43,269 P167296 INFO [Metrics] AUC: 0.830468 - logloss: 0.335249
2024-09-23 04:55:43,269 P167296 INFO Save best model: monitor(max)=0.830468
2024-09-23 04:55:43,344 P167296 INFO ************ Epoch=9 end ************
2024-09-23 04:56:20,368 P167296 INFO Train loss: 0.357731
2024-09-23 04:56:20,369 P167296 INFO Evaluation @epoch 10 - batch 171: 
2024-09-23 04:56:22,918 P167296 INFO [Metrics] AUC: 0.831590 - logloss: 0.334666
2024-09-23 04:56:22,919 P167296 INFO Save best model: monitor(max)=0.831590
2024-09-23 04:56:22,996 P167296 INFO ************ Epoch=10 end ************
2024-09-23 04:57:05,203 P167296 INFO Train loss: 0.356606
2024-09-23 04:57:05,203 P167296 INFO Evaluation @epoch 11 - batch 171: 
2024-09-23 04:57:07,926 P167296 INFO [Metrics] AUC: 0.831986 - logloss: 0.334452
2024-09-23 04:57:07,927 P167296 INFO Save best model: monitor(max)=0.831986
2024-09-23 04:57:08,004 P167296 INFO ************ Epoch=11 end ************
2024-09-23 04:57:49,615 P167296 INFO Train loss: 0.355986
2024-09-23 04:57:49,615 P167296 INFO Evaluation @epoch 12 - batch 171: 
2024-09-23 04:57:52,221 P167296 INFO [Metrics] AUC: 0.833184 - logloss: 0.333383
2024-09-23 04:57:52,222 P167296 INFO Save best model: monitor(max)=0.833184
2024-09-23 04:57:52,293 P167296 INFO ************ Epoch=12 end ************
2024-09-23 04:58:33,960 P167296 INFO Train loss: 0.355420
2024-09-23 04:58:33,961 P167296 INFO Evaluation @epoch 13 - batch 171: 
2024-09-23 04:58:36,451 P167296 INFO [Metrics] AUC: 0.834605 - logloss: 0.332243
2024-09-23 04:58:36,451 P167296 INFO Save best model: monitor(max)=0.834605
2024-09-23 04:58:36,538 P167296 INFO ************ Epoch=13 end ************
2024-09-23 04:59:18,791 P167296 INFO Train loss: 0.355024
2024-09-23 04:59:18,791 P167296 INFO Evaluation @epoch 14 - batch 171: 
2024-09-23 04:59:21,060 P167296 INFO [Metrics] AUC: 0.834890 - logloss: 0.332225
2024-09-23 04:59:21,061 P167296 INFO Save best model: monitor(max)=0.834890
2024-09-23 04:59:21,145 P167296 INFO ************ Epoch=14 end ************
2024-09-23 05:00:02,606 P167296 INFO Train loss: 0.354151
2024-09-23 05:00:02,607 P167296 INFO Evaluation @epoch 15 - batch 171: 
2024-09-23 05:00:05,135 P167296 INFO [Metrics] AUC: 0.836061 - logloss: 0.330972
2024-09-23 05:00:05,136 P167296 INFO Save best model: monitor(max)=0.836061
2024-09-23 05:00:05,215 P167296 INFO ************ Epoch=15 end ************
2024-09-23 05:00:43,669 P167296 INFO Train loss: 0.353711
2024-09-23 05:00:43,670 P167296 INFO Evaluation @epoch 16 - batch 171: 
2024-09-23 05:00:45,935 P167296 INFO [Metrics] AUC: 0.836032 - logloss: 0.331171
2024-09-23 05:00:45,936 P167296 INFO Monitor(max)=0.836032 STOP!
2024-09-23 05:00:45,937 P167296 INFO Reduce learning rate on plateau: 0.000100
2024-09-23 05:00:46,014 P167296 INFO ************ Epoch=16 end ************
2024-09-23 05:01:28,023 P167296 INFO Train loss: 0.335010
2024-09-23 05:01:28,023 P167296 INFO Evaluation @epoch 17 - batch 171: 
2024-09-23 05:01:30,581 P167296 INFO [Metrics] AUC: 0.844116 - logloss: 0.324627
2024-09-23 05:01:30,582 P167296 INFO Save best model: monitor(max)=0.844116
2024-09-23 05:01:30,659 P167296 INFO ************ Epoch=17 end ************
2024-09-23 05:02:12,326 P167296 INFO Train loss: 0.326054
2024-09-23 05:02:12,327 P167296 INFO Evaluation @epoch 18 - batch 171: 
2024-09-23 05:02:14,916 P167296 INFO [Metrics] AUC: 0.847136 - logloss: 0.322232
2024-09-23 05:02:14,917 P167296 INFO Save best model: monitor(max)=0.847136
2024-09-23 05:02:14,986 P167296 INFO ************ Epoch=18 end ************
2024-09-23 05:02:56,674 P167296 INFO Train loss: 0.322137
2024-09-23 05:02:56,674 P167296 INFO Evaluation @epoch 19 - batch 171: 
2024-09-23 05:02:59,093 P167296 INFO [Metrics] AUC: 0.848317 - logloss: 0.321335
2024-09-23 05:02:59,094 P167296 INFO Save best model: monitor(max)=0.848317
2024-09-23 05:02:59,168 P167296 INFO ************ Epoch=19 end ************
2024-09-23 05:03:41,319 P167296 INFO Train loss: 0.319653
2024-09-23 05:03:41,320 P167296 INFO Evaluation @epoch 20 - batch 171: 
2024-09-23 05:03:43,912 P167296 INFO [Metrics] AUC: 0.849110 - logloss: 0.320826
2024-09-23 05:03:43,913 P167296 INFO Save best model: monitor(max)=0.849110
2024-09-23 05:03:44,000 P167296 INFO ************ Epoch=20 end ************
2024-09-23 05:04:25,451 P167296 INFO Train loss: 0.317650
2024-09-23 05:04:25,451 P167296 INFO Evaluation @epoch 21 - batch 171: 
2024-09-23 05:04:27,985 P167296 INFO [Metrics] AUC: 0.849428 - logloss: 0.320640
2024-09-23 05:04:27,986 P167296 INFO Save best model: monitor(max)=0.849428
2024-09-23 05:04:28,063 P167296 INFO ************ Epoch=21 end ************
2024-09-23 05:05:10,031 P167296 INFO Train loss: 0.316206
2024-09-23 05:05:10,031 P167296 INFO Evaluation @epoch 22 - batch 171: 
2024-09-23 05:05:12,555 P167296 INFO [Metrics] AUC: 0.849768 - logloss: 0.320337
2024-09-23 05:05:12,555 P167296 INFO Save best model: monitor(max)=0.849768
2024-09-23 05:05:12,641 P167296 INFO ************ Epoch=22 end ************
2024-09-23 05:05:54,622 P167296 INFO Train loss: 0.314987
2024-09-23 05:05:54,623 P167296 INFO Evaluation @epoch 23 - batch 171: 
2024-09-23 05:05:57,236 P167296 INFO [Metrics] AUC: 0.850009 - logloss: 0.320318
2024-09-23 05:05:57,236 P167296 INFO Save best model: monitor(max)=0.850009
2024-09-23 05:05:57,310 P167296 INFO ************ Epoch=23 end ************
2024-09-23 05:06:39,240 P167296 INFO Train loss: 0.313618
2024-09-23 05:06:39,241 P167296 INFO Evaluation @epoch 24 - batch 171: 
2024-09-23 05:06:41,827 P167296 INFO [Metrics] AUC: 0.849943 - logloss: 0.320455
2024-09-23 05:06:41,827 P167296 INFO Monitor(max)=0.849943 STOP!
2024-09-23 05:06:41,828 P167296 INFO Reduce learning rate on plateau: 0.000010
2024-09-23 05:06:41,901 P167296 INFO ************ Epoch=24 end ************
2024-09-23 05:07:23,816 P167296 INFO Train loss: 0.306961
2024-09-23 05:07:23,816 P167296 INFO Evaluation @epoch 25 - batch 171: 
2024-09-23 05:07:26,267 P167296 INFO [Metrics] AUC: 0.850090 - logloss: 0.320484
2024-09-23 05:07:26,268 P167296 INFO Save best model: monitor(max)=0.850090
2024-09-23 05:07:26,352 P167296 INFO ************ Epoch=25 end ************
2024-09-23 05:08:07,685 P167296 INFO Train loss: 0.306511
2024-09-23 05:08:07,686 P167296 INFO Evaluation @epoch 26 - batch 171: 
2024-09-23 05:08:10,263 P167296 INFO [Metrics] AUC: 0.850182 - logloss: 0.320452
2024-09-23 05:08:10,264 P167296 INFO Save best model: monitor(max)=0.850182
2024-09-23 05:08:10,350 P167296 INFO ************ Epoch=26 end ************
2024-09-23 05:08:51,457 P167296 INFO Train loss: 0.306230
2024-09-23 05:08:51,458 P167296 INFO Evaluation @epoch 27 - batch 171: 
2024-09-23 05:08:54,090 P167296 INFO [Metrics] AUC: 0.850252 - logloss: 0.320406
2024-09-23 05:08:54,091 P167296 INFO Save best model: monitor(max)=0.850252
2024-09-23 05:08:54,172 P167296 INFO ************ Epoch=27 end ************
2024-09-23 05:09:36,616 P167296 INFO Train loss: 0.305848
2024-09-23 05:09:36,616 P167296 INFO Evaluation @epoch 28 - batch 171: 
2024-09-23 05:09:39,157 P167296 INFO [Metrics] AUC: 0.850298 - logloss: 0.320416
2024-09-23 05:09:39,158 P167296 INFO Save best model: monitor(max)=0.850298
2024-09-23 05:09:39,249 P167296 INFO ************ Epoch=28 end ************
2024-09-23 05:10:20,207 P167296 INFO Train loss: 0.305595
2024-09-23 05:10:20,207 P167296 INFO Evaluation @epoch 29 - batch 171: 
2024-09-23 05:10:22,612 P167296 INFO [Metrics] AUC: 0.850316 - logloss: 0.320466
2024-09-23 05:10:22,612 P167296 INFO Save best model: monitor(max)=0.850316
2024-09-23 05:10:22,686 P167296 INFO ************ Epoch=29 end ************
2024-09-23 05:11:04,338 P167296 INFO Train loss: 0.305473
2024-09-23 05:11:04,338 P167296 INFO Evaluation @epoch 30 - batch 171: 
2024-09-23 05:11:06,999 P167296 INFO [Metrics] AUC: 0.850350 - logloss: 0.320459
2024-09-23 05:11:06,999 P167296 INFO Save best model: monitor(max)=0.850350
2024-09-23 05:11:07,079 P167296 INFO ************ Epoch=30 end ************
2024-09-23 05:11:49,498 P167296 INFO Train loss: 0.305301
2024-09-23 05:11:49,499 P167296 INFO Evaluation @epoch 31 - batch 171: 
2024-09-23 05:11:52,069 P167296 INFO [Metrics] AUC: 0.850392 - logloss: 0.320412
2024-09-23 05:11:52,070 P167296 INFO Save best model: monitor(max)=0.850392
2024-09-23 05:11:52,142 P167296 INFO ************ Epoch=31 end ************
2024-09-23 05:12:33,626 P167296 INFO Train loss: 0.304794
2024-09-23 05:12:33,626 P167296 INFO Evaluation @epoch 32 - batch 171: 
2024-09-23 05:12:36,071 P167296 INFO [Metrics] AUC: 0.850411 - logloss: 0.320500
2024-09-23 05:12:36,072 P167296 INFO Save best model: monitor(max)=0.850411
2024-09-23 05:12:36,153 P167296 INFO ************ Epoch=32 end ************
2024-09-23 05:13:17,660 P167296 INFO Train loss: 0.304752
2024-09-23 05:13:17,661 P167296 INFO Evaluation @epoch 33 - batch 171: 
2024-09-23 05:13:20,214 P167296 INFO [Metrics] AUC: 0.850420 - logloss: 0.320402
2024-09-23 05:13:20,215 P167296 INFO Save best model: monitor(max)=0.850420
2024-09-23 05:13:20,290 P167296 INFO ************ Epoch=33 end ************
2024-09-23 05:14:02,493 P167296 INFO Train loss: 0.304309
2024-09-23 05:14:02,493 P167296 INFO Evaluation @epoch 34 - batch 171: 
2024-09-23 05:14:05,056 P167296 INFO [Metrics] AUC: 0.850409 - logloss: 0.320483
2024-09-23 05:14:05,056 P167296 INFO Monitor(max)=0.850409 STOP!
2024-09-23 05:14:05,057 P167296 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 05:14:05,127 P167296 INFO ************ Epoch=34 end ************
2024-09-23 05:14:46,919 P167296 INFO Train loss: 0.303763
2024-09-23 05:14:46,920 P167296 INFO Evaluation @epoch 35 - batch 171: 
2024-09-23 05:14:49,552 P167296 INFO [Metrics] AUC: 0.850411 - logloss: 0.320528
2024-09-23 05:14:49,553 P167296 INFO Monitor(max)=0.850411 STOP!
2024-09-23 05:14:49,553 P167296 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 05:14:49,553 P167296 INFO ********* Epoch=35 early stop *********
2024-09-23 05:14:49,626 P167296 INFO Training finished.
2024-09-23 05:14:49,627 P167296 INFO Load best model: /workspace/checkpoints/ML_1M_7_x1/DCNv3_ML_1M_009_a9112779.model
2024-09-23 05:14:49,647 P167296 INFO ****** Validation evaluation ******
2024-09-23 05:14:52,169 P167296 INFO [Metrics] logloss: 0.320402 - AUC: 0.850420
2024-09-23 05:14:52,326 P167296 INFO ******** Test evaluation ********
2024-09-23 05:14:52,326 P167296 INFO Loading datasets...
2024-09-23 05:14:52,613 P167296 INFO Test samples: total/100022, blocks/1
2024-09-23 05:14:52,613 P167296 INFO Loading test data done.
2024-09-23 05:14:54,040 P167296 INFO [Metrics] logloss: 0.319497 - AUC: 0.850145
