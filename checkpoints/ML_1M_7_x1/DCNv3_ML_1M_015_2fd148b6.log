2024-09-23 06:43:35,785 P210971 INFO FuxiCTR version: 2.3.2
2024-09-23 06:43:35,785 P210971 INFO Params: {
    "batch_norm": "True",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "dataset/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "deep_net_dropout": "0.2",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "layer_norm": "True",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DCNv3",
    "model_id": "DCNv3_ML_1M_015_2fd148b6",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_regularizer": "0",
    "num_deep_cross_layers": "1",
    "num_heads": "1",
    "num_shallow_cross_layers": "2",
    "num_workers": "4",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shallow_net_dropout": "0.3",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "dataset/ML_1M/test.csv",
    "train_data": "dataset/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "dataset/ML_1M/valid.csv",
    "verbose": "1"
}
2024-09-23 06:43:35,786 P210971 INFO Set up feature processor...
2024-09-23 06:43:35,787 P210971 WARNING Skip rebuilding dataset/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-09-23 06:43:35,787 P210971 INFO Load feature_map from json: dataset/ML_1M_7_x1/feature_map.json
2024-09-23 06:43:35,787 P210971 INFO Set column index...
2024-09-23 06:43:35,787 P210971 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'max_len': 5, 'vocab_size': 302}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 3659}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 83}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 6042}"
}
2024-09-23 06:43:37,224 P210971 INFO Total number of parameters: 181672.
2024-09-23 06:43:37,224 P210971 INFO Loading datasets...
2024-09-23 06:43:39,221 P210971 INFO Train samples: total/700146, blocks/1
2024-09-23 06:43:39,563 P210971 INFO Validation samples: total/200041, blocks/1
2024-09-23 06:43:39,564 P210971 INFO Loading train and validation data done.
2024-09-23 06:43:39,564 P210971 INFO Start training: 171 batches/epoch
2024-09-23 06:43:39,564 P210971 INFO ************ Epoch=1 start ************
2024-09-23 06:44:22,459 P210971 INFO Train loss: 0.441316
2024-09-23 06:44:22,459 P210971 INFO Evaluation @epoch 1 - batch 171: 
2024-09-23 06:44:25,072 P210971 INFO [Metrics] AUC: 0.803640 - logloss: 0.357214
2024-09-23 06:44:25,073 P210971 INFO Save best model: monitor(max)=0.803640
2024-09-23 06:44:25,114 P210971 INFO ************ Epoch=1 end ************
2024-09-23 06:45:09,802 P210971 INFO Train loss: 0.381191
2024-09-23 06:45:09,803 P210971 INFO Evaluation @epoch 2 - batch 171: 
2024-09-23 06:45:12,555 P210971 INFO [Metrics] AUC: 0.812616 - logloss: 0.349689
2024-09-23 06:45:12,556 P210971 INFO Save best model: monitor(max)=0.812616
2024-09-23 06:45:12,617 P210971 INFO ************ Epoch=2 end ************
2024-09-23 06:45:57,264 P210971 INFO Train loss: 0.373384
2024-09-23 06:45:57,264 P210971 INFO Evaluation @epoch 3 - batch 171: 
2024-09-23 06:46:00,007 P210971 INFO [Metrics] AUC: 0.817863 - logloss: 0.345331
2024-09-23 06:46:00,008 P210971 INFO Save best model: monitor(max)=0.817863
2024-09-23 06:46:00,063 P210971 INFO ************ Epoch=3 end ************
2024-09-23 06:46:44,415 P210971 INFO Train loss: 0.368898
2024-09-23 06:46:44,415 P210971 INFO Evaluation @epoch 4 - batch 171: 
2024-09-23 06:46:47,223 P210971 INFO [Metrics] AUC: 0.820355 - logloss: 0.343781
2024-09-23 06:46:47,224 P210971 INFO Save best model: monitor(max)=0.820355
2024-09-23 06:46:47,296 P210971 INFO ************ Epoch=4 end ************
2024-09-23 06:47:31,642 P210971 INFO Train loss: 0.366277
2024-09-23 06:47:31,642 P210971 INFO Evaluation @epoch 5 - batch 171: 
2024-09-23 06:47:34,474 P210971 INFO [Metrics] AUC: 0.825499 - logloss: 0.339670
2024-09-23 06:47:34,474 P210971 INFO Save best model: monitor(max)=0.825499
2024-09-23 06:47:34,536 P210971 INFO ************ Epoch=5 end ************
2024-09-23 06:48:18,804 P210971 INFO Train loss: 0.364595
2024-09-23 06:48:18,805 P210971 INFO Evaluation @epoch 6 - batch 171: 
2024-09-23 06:48:21,653 P210971 INFO [Metrics] AUC: 0.828276 - logloss: 0.337335
2024-09-23 06:48:21,654 P210971 INFO Save best model: monitor(max)=0.828276
2024-09-23 06:48:21,722 P210971 INFO ************ Epoch=6 end ************
2024-09-23 06:49:05,702 P210971 INFO Train loss: 0.362397
2024-09-23 06:49:05,703 P210971 INFO Evaluation @epoch 7 - batch 171: 
2024-09-23 06:49:08,410 P210971 INFO [Metrics] AUC: 0.830780 - logloss: 0.335330
2024-09-23 06:49:08,411 P210971 INFO Save best model: monitor(max)=0.830780
2024-09-23 06:49:08,496 P210971 INFO ************ Epoch=7 end ************
2024-09-23 06:49:52,839 P210971 INFO Train loss: 0.360330
2024-09-23 06:49:52,839 P210971 INFO Evaluation @epoch 8 - batch 171: 
2024-09-23 06:49:55,671 P210971 INFO [Metrics] AUC: 0.832813 - logloss: 0.333817
2024-09-23 06:49:55,672 P210971 INFO Save best model: monitor(max)=0.832813
2024-09-23 06:49:55,730 P210971 INFO ************ Epoch=8 end ************
2024-09-23 06:50:38,904 P210971 INFO Train loss: 0.358969
2024-09-23 06:50:38,905 P210971 INFO Evaluation @epoch 9 - batch 171: 
2024-09-23 06:50:41,663 P210971 INFO [Metrics] AUC: 0.833183 - logloss: 0.333358
2024-09-23 06:50:41,663 P210971 INFO Save best model: monitor(max)=0.833183
2024-09-23 06:50:41,725 P210971 INFO ************ Epoch=9 end ************
2024-09-23 06:51:26,323 P210971 INFO Train loss: 0.357272
2024-09-23 06:51:26,323 P210971 INFO Evaluation @epoch 10 - batch 171: 
2024-09-23 06:51:29,028 P210971 INFO [Metrics] AUC: 0.835558 - logloss: 0.331713
2024-09-23 06:51:29,029 P210971 INFO Save best model: monitor(max)=0.835558
2024-09-23 06:51:29,082 P210971 INFO ************ Epoch=10 end ************
2024-09-23 06:52:12,762 P210971 INFO Train loss: 0.356418
2024-09-23 06:52:12,763 P210971 INFO Evaluation @epoch 11 - batch 171: 
2024-09-23 06:52:15,561 P210971 INFO [Metrics] AUC: 0.836745 - logloss: 0.331299
2024-09-23 06:52:15,562 P210971 INFO Save best model: monitor(max)=0.836745
2024-09-23 06:52:15,668 P210971 INFO ************ Epoch=11 end ************
2024-09-23 06:52:59,883 P210971 INFO Train loss: 0.355495
2024-09-23 06:52:59,884 P210971 INFO Evaluation @epoch 12 - batch 171: 
2024-09-23 06:53:02,645 P210971 INFO [Metrics] AUC: 0.838216 - logloss: 0.329764
2024-09-23 06:53:02,646 P210971 INFO Save best model: monitor(max)=0.838216
2024-09-23 06:53:02,722 P210971 INFO ************ Epoch=12 end ************
2024-09-23 06:53:47,420 P210971 INFO Train loss: 0.354640
2024-09-23 06:53:47,420 P210971 INFO Evaluation @epoch 13 - batch 171: 
2024-09-23 06:53:50,206 P210971 INFO [Metrics] AUC: 0.838462 - logloss: 0.329363
2024-09-23 06:53:50,207 P210971 INFO Save best model: monitor(max)=0.838462
2024-09-23 06:53:50,271 P210971 INFO ************ Epoch=13 end ************
2024-09-23 06:54:34,332 P210971 INFO Train loss: 0.354262
2024-09-23 06:54:34,332 P210971 INFO Evaluation @epoch 14 - batch 171: 
2024-09-23 06:54:36,760 P210971 INFO [Metrics] AUC: 0.839131 - logloss: 0.328884
2024-09-23 06:54:36,761 P210971 INFO Save best model: monitor(max)=0.839131
2024-09-23 06:54:36,819 P210971 INFO ************ Epoch=14 end ************
2024-09-23 06:55:17,617 P210971 INFO Train loss: 0.353145
2024-09-23 06:55:17,617 P210971 INFO Evaluation @epoch 15 - batch 171: 
2024-09-23 06:55:20,444 P210971 INFO [Metrics] AUC: 0.839716 - logloss: 0.328299
2024-09-23 06:55:20,445 P210971 INFO Save best model: monitor(max)=0.839716
2024-09-23 06:55:20,515 P210971 INFO ************ Epoch=15 end ************
2024-09-23 06:56:05,089 P210971 INFO Train loss: 0.353174
2024-09-23 06:56:05,089 P210971 INFO Evaluation @epoch 16 - batch 171: 
2024-09-23 06:56:07,852 P210971 INFO [Metrics] AUC: 0.840389 - logloss: 0.327558
2024-09-23 06:56:07,853 P210971 INFO Save best model: monitor(max)=0.840389
2024-09-23 06:56:07,912 P210971 INFO ************ Epoch=16 end ************
2024-09-23 06:56:52,076 P210971 INFO Train loss: 0.352954
2024-09-23 06:56:52,077 P210971 INFO Evaluation @epoch 17 - batch 171: 
2024-09-23 06:56:54,833 P210971 INFO [Metrics] AUC: 0.840481 - logloss: 0.328320
2024-09-23 06:56:54,834 P210971 INFO Save best model: monitor(max)=0.840481
2024-09-23 06:56:54,903 P210971 INFO ************ Epoch=17 end ************
2024-09-23 06:57:38,931 P210971 INFO Train loss: 0.352639
2024-09-23 06:57:38,931 P210971 INFO Evaluation @epoch 18 - batch 171: 
2024-09-23 06:57:41,820 P210971 INFO [Metrics] AUC: 0.841549 - logloss: 0.327016
2024-09-23 06:57:41,820 P210971 INFO Save best model: monitor(max)=0.841549
2024-09-23 06:57:41,876 P210971 INFO ************ Epoch=18 end ************
2024-09-23 06:58:26,610 P210971 INFO Train loss: 0.352349
2024-09-23 06:58:26,610 P210971 INFO Evaluation @epoch 19 - batch 171: 
2024-09-23 06:58:29,440 P210971 INFO [Metrics] AUC: 0.840929 - logloss: 0.327356
2024-09-23 06:58:29,441 P210971 INFO Monitor(max)=0.840929 STOP!
2024-09-23 06:58:29,441 P210971 INFO Reduce learning rate on plateau: 0.000100
2024-09-23 06:58:29,499 P210971 INFO ************ Epoch=19 end ************
2024-09-23 06:59:13,788 P210971 INFO Train loss: 0.329650
2024-09-23 06:59:13,789 P210971 INFO Evaluation @epoch 20 - batch 171: 
2024-09-23 06:59:16,422 P210971 INFO [Metrics] AUC: 0.848953 - logloss: 0.320934
2024-09-23 06:59:16,422 P210971 INFO Save best model: monitor(max)=0.848953
2024-09-23 06:59:16,493 P210971 INFO ************ Epoch=20 end ************
2024-09-23 07:00:00,867 P210971 INFO Train loss: 0.318928
2024-09-23 07:00:00,868 P210971 INFO Evaluation @epoch 21 - batch 171: 
2024-09-23 07:00:03,712 P210971 INFO [Metrics] AUC: 0.852134 - logloss: 0.318525
2024-09-23 07:00:03,713 P210971 INFO Save best model: monitor(max)=0.852134
2024-09-23 07:00:03,792 P210971 INFO ************ Epoch=21 end ************
2024-09-23 07:00:48,673 P210971 INFO Train loss: 0.313494
2024-09-23 07:00:48,674 P210971 INFO Evaluation @epoch 22 - batch 171: 
2024-09-23 07:00:51,518 P210971 INFO [Metrics] AUC: 0.853527 - logloss: 0.317232
2024-09-23 07:00:51,519 P210971 INFO Save best model: monitor(max)=0.853527
2024-09-23 07:00:51,577 P210971 INFO ************ Epoch=22 end ************
2024-09-23 07:01:35,633 P210971 INFO Train loss: 0.309625
2024-09-23 07:01:35,634 P210971 INFO Evaluation @epoch 23 - batch 171: 
2024-09-23 07:01:38,398 P210971 INFO [Metrics] AUC: 0.853860 - logloss: 0.317255
2024-09-23 07:01:38,399 P210971 INFO Save best model: monitor(max)=0.853860
2024-09-23 07:01:38,468 P210971 INFO ************ Epoch=23 end ************
2024-09-23 07:02:23,295 P210971 INFO Train loss: 0.307129
2024-09-23 07:02:23,295 P210971 INFO Evaluation @epoch 24 - batch 171: 
2024-09-23 07:02:26,058 P210971 INFO [Metrics] AUC: 0.854095 - logloss: 0.317224
2024-09-23 07:02:26,059 P210971 INFO Save best model: monitor(max)=0.854095
2024-09-23 07:02:26,146 P210971 INFO ************ Epoch=24 end ************
2024-09-23 07:03:10,683 P210971 INFO Train loss: 0.304428
2024-09-23 07:03:10,683 P210971 INFO Evaluation @epoch 25 - batch 171: 
2024-09-23 07:03:13,404 P210971 INFO [Metrics] AUC: 0.854307 - logloss: 0.317250
2024-09-23 07:03:13,404 P210971 INFO Save best model: monitor(max)=0.854307
2024-09-23 07:03:13,475 P210971 INFO ************ Epoch=25 end ************
2024-09-23 07:03:57,649 P210971 INFO Train loss: 0.302395
2024-09-23 07:03:57,649 P210971 INFO Evaluation @epoch 26 - batch 171: 
2024-09-23 07:04:00,415 P210971 INFO [Metrics] AUC: 0.853820 - logloss: 0.317631
2024-09-23 07:04:00,416 P210971 INFO Monitor(max)=0.853820 STOP!
2024-09-23 07:04:00,416 P210971 INFO Reduce learning rate on plateau: 0.000010
2024-09-23 07:04:00,470 P210971 INFO ************ Epoch=26 end ************
2024-09-23 07:04:45,145 P210971 INFO Train loss: 0.292777
2024-09-23 07:04:45,145 P210971 INFO Evaluation @epoch 27 - batch 171: 
2024-09-23 07:04:47,953 P210971 INFO [Metrics] AUC: 0.854068 - logloss: 0.318224
2024-09-23 07:04:47,954 P210971 INFO Monitor(max)=0.854068 STOP!
2024-09-23 07:04:47,954 P210971 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 07:04:47,954 P210971 INFO ********* Epoch=27 early stop *********
2024-09-23 07:04:48,007 P210971 INFO Training finished.
2024-09-23 07:04:48,008 P210971 INFO Load best model: /workspace/checkpoints/ML_1M_7_x1/DCNv3_ML_1M_015_2fd148b6.model
2024-09-23 07:04:48,033 P210971 INFO ****** Validation evaluation ******
2024-09-23 07:04:50,754 P210971 INFO [Metrics] logloss: 0.317250 - AUC: 0.854307
2024-09-23 07:04:50,912 P210971 INFO ******** Test evaluation ********
2024-09-23 07:04:50,913 P210971 INFO Loading datasets...
2024-09-23 07:04:51,203 P210971 INFO Test samples: total/100022, blocks/1
2024-09-23 07:04:51,203 P210971 INFO Loading test data done.
2024-09-23 07:04:52,969 P210971 INFO [Metrics] logloss: 0.316328 - AUC: 0.853851
