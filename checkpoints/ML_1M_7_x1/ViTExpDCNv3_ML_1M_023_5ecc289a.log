2024-09-23 09:24:03,189 P267465 INFO FuxiCTR version: 2.3.2
2024-09-23 09:24:03,189 P267465 INFO Params: {
    "batch_norm": "True",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "dataset/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "deep_net_dropout": "0.1",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "layer_norm": "True",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "ViTExpDCNv3",
    "model_id": "ViTExpDCNv3_ML_1M_023_5ecc289a",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_regularizer": "0",
    "num_deep_cross_layers": "2",
    "num_heads": "1",
    "num_shallow_cross_layers": "2",
    "num_workers": "4",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shallow_net_dropout": "0.1",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "dataset/ML_1M/test.csv",
    "train_data": "dataset/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "dataset/ML_1M/valid.csv",
    "verbose": "1",
    "vit_hidden_dim": "128",
    "vit_num_heads": "4",
    "vit_num_layers": "2",
    "vit_patch_size": "4"
}
2024-09-23 09:24:03,190 P267465 INFO Set up feature processor...
2024-09-23 09:24:03,191 P267465 WARNING Skip rebuilding dataset/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-09-23 09:24:03,191 P267465 INFO Load feature_map from json: dataset/ML_1M_7_x1/feature_map.json
2024-09-23 09:24:03,191 P267465 INFO Set column index...
2024-09-23 09:24:03,191 P267465 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'max_len': 5, 'vocab_size': 302}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 3659}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 83}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 6042}"
}
2024-09-23 09:24:04,734 P267465 INFO Total number of parameters: 2579322.
2024-09-23 09:24:04,734 P267465 INFO Loading datasets...
2024-09-23 09:24:06,727 P267465 INFO Train samples: total/700146, blocks/1
2024-09-23 09:24:07,369 P267465 INFO Validation samples: total/200041, blocks/1
2024-09-23 09:24:07,369 P267465 INFO Loading train and validation data done.
2024-09-23 09:24:07,369 P267465 INFO Start training: 171 batches/epoch
2024-09-23 09:24:07,370 P267465 INFO ************ Epoch=1 start ************
2024-09-23 09:25:24,743 P267465 INFO Train loss: 0.401505
2024-09-23 09:25:24,744 P267465 INFO Evaluation @epoch 1 - batch 171: 
2024-09-23 09:25:29,788 P267465 INFO [Metrics] AUC: 0.815023 - logloss: 0.347636
2024-09-23 09:25:29,788 P267465 INFO Save best model: monitor(max)=0.815023
2024-09-23 09:25:29,862 P267465 INFO ************ Epoch=1 end ************
2024-09-23 09:26:46,153 P267465 INFO Train loss: 0.366456
2024-09-23 09:26:46,153 P267465 INFO Evaluation @epoch 2 - batch 171: 
2024-09-23 09:26:51,392 P267465 INFO [Metrics] AUC: 0.821499 - logloss: 0.342682
2024-09-23 09:26:51,393 P267465 INFO Save best model: monitor(max)=0.821499
2024-09-23 09:26:51,462 P267465 INFO ************ Epoch=2 end ************
2024-09-23 09:28:08,764 P267465 INFO Train loss: 0.361644
2024-09-23 09:28:08,764 P267465 INFO Evaluation @epoch 3 - batch 171: 
2024-09-23 09:28:14,007 P267465 INFO [Metrics] AUC: 0.827035 - logloss: 0.338597
2024-09-23 09:28:14,008 P267465 INFO Save best model: monitor(max)=0.827035
2024-09-23 09:28:14,107 P267465 INFO ************ Epoch=3 end ************
2024-09-23 09:29:30,830 P267465 INFO Train loss: 0.358779
2024-09-23 09:29:30,830 P267465 INFO Evaluation @epoch 4 - batch 171: 
2024-09-23 09:29:36,008 P267465 INFO [Metrics] AUC: 0.830624 - logloss: 0.335343
2024-09-23 09:29:36,009 P267465 INFO Save best model: monitor(max)=0.830624
2024-09-23 09:29:36,077 P267465 INFO ************ Epoch=4 end ************
2024-09-23 09:30:51,577 P267465 INFO Train loss: 0.358001
2024-09-23 09:30:51,578 P267465 INFO Evaluation @epoch 5 - batch 171: 
2024-09-23 09:30:56,044 P267465 INFO [Metrics] AUC: 0.833757 - logloss: 0.332989
2024-09-23 09:30:56,045 P267465 INFO Save best model: monitor(max)=0.833757
2024-09-23 09:30:56,125 P267465 INFO ************ Epoch=5 end ************
2024-09-23 09:32:10,268 P267465 INFO Train loss: 0.356040
2024-09-23 09:32:10,269 P267465 INFO Evaluation @epoch 6 - batch 171: 
2024-09-23 09:32:15,492 P267465 INFO [Metrics] AUC: 0.836296 - logloss: 0.331004
2024-09-23 09:32:15,492 P267465 INFO Save best model: monitor(max)=0.836296
2024-09-23 09:32:15,564 P267465 INFO ************ Epoch=6 end ************
2024-09-23 09:33:31,829 P267465 INFO Train loss: 0.355004
2024-09-23 09:33:31,829 P267465 INFO Evaluation @epoch 7 - batch 171: 
2024-09-23 09:33:36,944 P267465 INFO [Metrics] AUC: 0.838400 - logloss: 0.329794
2024-09-23 09:33:36,944 P267465 INFO Save best model: monitor(max)=0.838400
2024-09-23 09:33:37,029 P267465 INFO ************ Epoch=7 end ************
2024-09-23 09:34:53,627 P267465 INFO Train loss: 0.353647
2024-09-23 09:34:53,628 P267465 INFO Evaluation @epoch 8 - batch 171: 
2024-09-23 09:34:58,956 P267465 INFO [Metrics] AUC: 0.840021 - logloss: 0.328471
2024-09-23 09:34:58,957 P267465 INFO Save best model: monitor(max)=0.840021
2024-09-23 09:34:59,049 P267465 INFO ************ Epoch=8 end ************
2024-09-23 09:36:15,730 P267465 INFO Train loss: 0.352663
2024-09-23 09:36:15,730 P267465 INFO Evaluation @epoch 9 - batch 171: 
2024-09-23 09:36:21,235 P267465 INFO [Metrics] AUC: 0.841121 - logloss: 0.327315
2024-09-23 09:36:21,236 P267465 INFO Save best model: monitor(max)=0.841121
2024-09-23 09:36:21,348 P267465 INFO ************ Epoch=9 end ************
2024-09-23 09:37:34,609 P267465 INFO Train loss: 0.352197
2024-09-23 09:37:34,610 P267465 INFO Evaluation @epoch 10 - batch 171: 
2024-09-23 09:37:39,593 P267465 INFO [Metrics] AUC: 0.842213 - logloss: 0.326612
2024-09-23 09:37:39,594 P267465 INFO Save best model: monitor(max)=0.842213
2024-09-23 09:37:39,669 P267465 INFO ************ Epoch=10 end ************
2024-09-23 09:38:54,067 P267465 INFO Train loss: 0.351224
2024-09-23 09:38:54,068 P267465 INFO Evaluation @epoch 11 - batch 171: 
2024-09-23 09:38:59,390 P267465 INFO [Metrics] AUC: 0.842388 - logloss: 0.326148
2024-09-23 09:38:59,390 P267465 INFO Save best model: monitor(max)=0.842388
2024-09-23 09:38:59,468 P267465 INFO ************ Epoch=11 end ************
2024-09-23 09:40:14,911 P267465 INFO Train loss: 0.350883
2024-09-23 09:40:14,911 P267465 INFO Evaluation @epoch 12 - batch 171: 
2024-09-23 09:40:19,983 P267465 INFO [Metrics] AUC: 0.843118 - logloss: 0.326106
2024-09-23 09:40:19,984 P267465 INFO Save best model: monitor(max)=0.843118
2024-09-23 09:40:20,075 P267465 INFO ************ Epoch=12 end ************
2024-09-23 09:41:35,741 P267465 INFO Train loss: 0.350628
2024-09-23 09:41:35,741 P267465 INFO Evaluation @epoch 13 - batch 171: 
2024-09-23 09:41:40,708 P267465 INFO [Metrics] AUC: 0.843901 - logloss: 0.325484
2024-09-23 09:41:40,709 P267465 INFO Save best model: monitor(max)=0.843901
2024-09-23 09:41:40,791 P267465 INFO ************ Epoch=13 end ************
2024-09-23 09:42:55,852 P267465 INFO Train loss: 0.349933
2024-09-23 09:42:55,853 P267465 INFO Evaluation @epoch 14 - batch 171: 
2024-09-23 09:43:01,087 P267465 INFO [Metrics] AUC: 0.844252 - logloss: 0.324646
2024-09-23 09:43:01,088 P267465 INFO Save best model: monitor(max)=0.844252
2024-09-23 09:43:01,175 P267465 INFO ************ Epoch=14 end ************
2024-09-23 09:44:12,454 P267465 INFO Train loss: 0.349710
2024-09-23 09:44:12,454 P267465 INFO Evaluation @epoch 15 - batch 171: 
2024-09-23 09:44:17,580 P267465 INFO [Metrics] AUC: 0.844503 - logloss: 0.324656
2024-09-23 09:44:17,581 P267465 INFO Save best model: monitor(max)=0.844503
2024-09-23 09:44:17,659 P267465 INFO ************ Epoch=15 end ************
2024-09-23 09:45:32,686 P267465 INFO Train loss: 0.349370
2024-09-23 09:45:32,686 P267465 INFO Evaluation @epoch 16 - batch 171: 
2024-09-23 09:45:37,829 P267465 INFO [Metrics] AUC: 0.843854 - logloss: 0.324987
2024-09-23 09:45:37,830 P267465 INFO Monitor(max)=0.843854 STOP!
2024-09-23 09:45:37,830 P267465 INFO Reduce learning rate on plateau: 0.000100
2024-09-23 09:45:37,908 P267465 INFO ************ Epoch=16 end ************
2024-09-23 09:46:53,436 P267465 INFO Train loss: 0.321433
2024-09-23 09:46:53,437 P267465 INFO Evaluation @epoch 17 - batch 171: 
2024-09-23 09:46:58,824 P267465 INFO [Metrics] AUC: 0.851588 - logloss: 0.319968
2024-09-23 09:46:58,825 P267465 INFO Save best model: monitor(max)=0.851588
2024-09-23 09:46:58,905 P267465 INFO ************ Epoch=17 end ************
2024-09-23 09:48:08,803 P267465 INFO Train loss: 0.308594
2024-09-23 09:48:08,804 P267465 INFO Evaluation @epoch 18 - batch 171: 
2024-09-23 09:48:14,210 P267465 INFO [Metrics] AUC: 0.853807 - logloss: 0.319121
2024-09-23 09:48:14,211 P267465 INFO Save best model: monitor(max)=0.853807
2024-09-23 09:48:14,318 P267465 INFO ************ Epoch=18 end ************
2024-09-23 09:49:30,817 P267465 INFO Train loss: 0.301626
2024-09-23 09:49:30,818 P267465 INFO Evaluation @epoch 19 - batch 171: 
2024-09-23 09:49:35,904 P267465 INFO [Metrics] AUC: 0.854125 - logloss: 0.319311
2024-09-23 09:49:35,905 P267465 INFO Save best model: monitor(max)=0.854125
2024-09-23 09:49:36,006 P267465 INFO ************ Epoch=19 end ************
2024-09-23 09:50:51,751 P267465 INFO Train loss: 0.297070
2024-09-23 09:50:51,751 P267465 INFO Evaluation @epoch 20 - batch 171: 
2024-09-23 09:50:57,437 P267465 INFO [Metrics] AUC: 0.853565 - logloss: 0.321268
2024-09-23 09:50:57,439 P267465 INFO Monitor(max)=0.853565 STOP!
2024-09-23 09:50:57,440 P267465 INFO Reduce learning rate on plateau: 0.000010
2024-09-23 09:50:57,542 P267465 INFO ************ Epoch=20 end ************
2024-09-23 09:52:13,148 P267465 INFO Train loss: 0.284173
2024-09-23 09:52:13,148 P267465 INFO Evaluation @epoch 21 - batch 171: 
2024-09-23 09:52:18,331 P267465 INFO [Metrics] AUC: 0.853192 - logloss: 0.323485
2024-09-23 09:52:18,332 P267465 INFO Monitor(max)=0.853192 STOP!
2024-09-23 09:52:18,334 P267465 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 09:52:18,334 P267465 INFO ********* Epoch=21 early stop *********
2024-09-23 09:52:18,429 P267465 INFO Training finished.
2024-09-23 09:52:18,429 P267465 INFO Load best model: /workspace/checkpoints/ML_1M_7_x1/ViTExpDCNv3_ML_1M_023_5ecc289a.model
