2024-09-23 05:16:44,404 P177749 INFO FuxiCTR version: 2.3.2
2024-09-23 05:16:44,405 P177749 INFO Params: {
    "batch_norm": "False",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "dataset/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "layer_norm": "True",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "ViTDCNv2",
    "model_id": "ViTDCNv2_ML_1M_009_0fd3c701",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_dropout": "0.1",
    "net_regularizer": "0",
    "num_cross_layers": "2",
    "num_heads": "1",
    "num_workers": "4",
    "optimizer": "adam",
    "parallel_dnn_hidden_units": "[512, 128]",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "dataset/ML_1M/test.csv",
    "train_data": "dataset/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "dataset/ML_1M/valid.csv",
    "verbose": "1",
    "vit_hidden_dim": "32",
    "vit_num_heads": "8",
    "vit_num_layers": "4",
    "vit_patch_size": "4"
}
2024-09-23 05:16:44,406 P177749 INFO Set up feature processor...
2024-09-23 05:16:44,406 P177749 WARNING Skip rebuilding dataset/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-09-23 05:16:44,407 P177749 INFO Load feature_map from json: dataset/ML_1M_7_x1/feature_map.json
2024-09-23 05:16:44,407 P177749 INFO Set column index...
2024-09-23 05:16:44,407 P177749 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'max_len': 5, 'vocab_size': 302}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 3659}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 83}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 6042}"
}
2024-09-23 05:16:45,645 P177749 INFO Total number of parameters: 1420049.
2024-09-23 05:16:45,646 P177749 INFO Loading datasets...
2024-09-23 05:16:47,678 P177749 INFO Train samples: total/700146, blocks/1
2024-09-23 05:16:47,998 P177749 INFO Validation samples: total/200041, blocks/1
2024-09-23 05:16:47,998 P177749 INFO Loading train and validation data done.
2024-09-23 05:16:47,998 P177749 INFO Start training: 171 batches/epoch
2024-09-23 05:16:47,998 P177749 INFO ************ Epoch=1 start ************
2024-09-23 05:18:21,249 P177749 INFO Train loss: 0.415389
2024-09-23 05:18:21,250 P177749 INFO Evaluation @epoch 1 - batch 171: 
2024-09-23 05:18:26,515 P177749 INFO [Metrics] AUC: 0.801123 - logloss: 0.358628
2024-09-23 05:18:26,516 P177749 INFO Save best model: monitor(max)=0.801123
2024-09-23 05:18:26,574 P177749 INFO ************ Epoch=1 end ************
2024-09-23 05:19:57,992 P177749 INFO Train loss: 0.377235
2024-09-23 05:19:57,992 P177749 INFO Evaluation @epoch 2 - batch 171: 
2024-09-23 05:20:03,308 P177749 INFO [Metrics] AUC: 0.804744 - logloss: 0.355184
2024-09-23 05:20:03,309 P177749 INFO Save best model: monitor(max)=0.804744
2024-09-23 05:20:03,379 P177749 INFO ************ Epoch=2 end ************
2024-09-23 05:21:34,478 P177749 INFO Train loss: 0.372297
2024-09-23 05:21:34,479 P177749 INFO Evaluation @epoch 3 - batch 171: 
2024-09-23 05:21:39,762 P177749 INFO [Metrics] AUC: 0.810249 - logloss: 0.350848
2024-09-23 05:21:39,763 P177749 INFO Save best model: monitor(max)=0.810249
2024-09-23 05:21:39,833 P177749 INFO ************ Epoch=3 end ************
2024-09-23 05:23:07,382 P177749 INFO Train loss: 0.366523
2024-09-23 05:23:07,382 P177749 INFO Evaluation @epoch 4 - batch 171: 
2024-09-23 05:23:12,692 P177749 INFO [Metrics] AUC: 0.817773 - logloss: 0.345250
2024-09-23 05:23:12,692 P177749 INFO Save best model: monitor(max)=0.817773
2024-09-23 05:23:12,760 P177749 INFO ************ Epoch=4 end ************
2024-09-23 05:24:43,825 P177749 INFO Train loss: 0.362012
2024-09-23 05:24:43,826 P177749 INFO Evaluation @epoch 5 - batch 171: 
2024-09-23 05:24:49,089 P177749 INFO [Metrics] AUC: 0.825232 - logloss: 0.339997
2024-09-23 05:24:49,090 P177749 INFO Save best model: monitor(max)=0.825232
2024-09-23 05:24:49,168 P177749 INFO ************ Epoch=5 end ************
2024-09-23 05:26:20,071 P177749 INFO Train loss: 0.358929
2024-09-23 05:26:20,072 P177749 INFO Evaluation @epoch 6 - batch 171: 
2024-09-23 05:26:25,379 P177749 INFO [Metrics] AUC: 0.828984 - logloss: 0.336482
2024-09-23 05:26:25,380 P177749 INFO Save best model: monitor(max)=0.828984
2024-09-23 05:26:25,446 P177749 INFO ************ Epoch=6 end ************
2024-09-23 05:27:56,920 P177749 INFO Train loss: 0.356809
2024-09-23 05:27:56,920 P177749 INFO Evaluation @epoch 7 - batch 171: 
2024-09-23 05:28:02,285 P177749 INFO [Metrics] AUC: 0.831423 - logloss: 0.335805
2024-09-23 05:28:02,285 P177749 INFO Save best model: monitor(max)=0.831423
2024-09-23 05:28:02,368 P177749 INFO ************ Epoch=7 end ************
2024-09-23 05:29:33,765 P177749 INFO Train loss: 0.355800
2024-09-23 05:29:33,766 P177749 INFO Evaluation @epoch 8 - batch 171: 
2024-09-23 05:29:39,020 P177749 INFO [Metrics] AUC: 0.835483 - logloss: 0.331587
2024-09-23 05:29:39,021 P177749 INFO Save best model: monitor(max)=0.835483
2024-09-23 05:29:39,101 P177749 INFO ************ Epoch=8 end ************
2024-09-23 05:31:10,241 P177749 INFO Train loss: 0.354077
2024-09-23 05:31:10,242 P177749 INFO Evaluation @epoch 9 - batch 171: 
2024-09-23 05:31:15,573 P177749 INFO [Metrics] AUC: 0.836515 - logloss: 0.331102
2024-09-23 05:31:15,574 P177749 INFO Save best model: monitor(max)=0.836515
2024-09-23 05:31:15,658 P177749 INFO ************ Epoch=9 end ************
2024-09-23 05:32:44,020 P177749 INFO Train loss: 0.352380
2024-09-23 05:32:44,021 P177749 INFO Evaluation @epoch 10 - batch 171: 
2024-09-23 05:32:48,896 P177749 INFO [Metrics] AUC: 0.836721 - logloss: 0.331022
2024-09-23 05:32:48,897 P177749 INFO Save best model: monitor(max)=0.836721
2024-09-23 05:32:48,965 P177749 INFO ************ Epoch=10 end ************
2024-09-23 05:34:19,952 P177749 INFO Train loss: 0.351021
2024-09-23 05:34:19,952 P177749 INFO Evaluation @epoch 11 - batch 171: 
2024-09-23 05:34:25,085 P177749 INFO [Metrics] AUC: 0.838807 - logloss: 0.329174
2024-09-23 05:34:25,085 P177749 INFO Save best model: monitor(max)=0.838807
2024-09-23 05:34:25,154 P177749 INFO ************ Epoch=11 end ************
2024-09-23 05:35:56,921 P177749 INFO Train loss: 0.349632
2024-09-23 05:35:56,922 P177749 INFO Evaluation @epoch 12 - batch 171: 
2024-09-23 05:36:02,071 P177749 INFO [Metrics] AUC: 0.840210 - logloss: 0.328485
2024-09-23 05:36:02,071 P177749 INFO Save best model: monitor(max)=0.840210
2024-09-23 05:36:02,146 P177749 INFO ************ Epoch=12 end ************
2024-09-23 05:37:33,612 P177749 INFO Train loss: 0.348800
2024-09-23 05:37:33,613 P177749 INFO Evaluation @epoch 13 - batch 171: 
2024-09-23 05:37:38,880 P177749 INFO [Metrics] AUC: 0.841137 - logloss: 0.327486
2024-09-23 05:37:38,881 P177749 INFO Save best model: monitor(max)=0.841137
2024-09-23 05:37:38,951 P177749 INFO ************ Epoch=13 end ************
2024-09-23 05:39:06,591 P177749 INFO Train loss: 0.347671
2024-09-23 05:39:06,591 P177749 INFO Evaluation @epoch 14 - batch 171: 
2024-09-23 05:39:11,423 P177749 INFO [Metrics] AUC: 0.841358 - logloss: 0.326989
2024-09-23 05:39:11,424 P177749 INFO Save best model: monitor(max)=0.841358
2024-09-23 05:39:11,497 P177749 INFO ************ Epoch=14 end ************
2024-09-23 05:40:39,896 P177749 INFO Train loss: 0.346823
2024-09-23 05:40:39,897 P177749 INFO Evaluation @epoch 15 - batch 171: 
2024-09-23 05:40:43,998 P177749 INFO [Metrics] AUC: 0.842222 - logloss: 0.326256
2024-09-23 05:40:43,999 P177749 INFO Save best model: monitor(max)=0.842222
2024-09-23 05:40:44,117 P177749 INFO ************ Epoch=15 end ************
2024-09-23 05:42:13,998 P177749 INFO Train loss: 0.346335
2024-09-23 05:42:13,999 P177749 INFO Evaluation @epoch 16 - batch 171: 
2024-09-23 05:42:19,297 P177749 INFO [Metrics] AUC: 0.843359 - logloss: 0.325531
2024-09-23 05:42:19,298 P177749 INFO Save best model: monitor(max)=0.843359
2024-09-23 05:42:19,374 P177749 INFO ************ Epoch=16 end ************
2024-09-23 05:43:50,093 P177749 INFO Train loss: 0.345697
2024-09-23 05:43:50,093 P177749 INFO Evaluation @epoch 17 - batch 171: 
2024-09-23 05:43:55,407 P177749 INFO [Metrics] AUC: 0.843478 - logloss: 0.325467
2024-09-23 05:43:55,407 P177749 INFO Save best model: monitor(max)=0.843478
2024-09-23 05:43:55,485 P177749 INFO ************ Epoch=17 end ************
2024-09-23 05:45:25,841 P177749 INFO Train loss: 0.345742
2024-09-23 05:45:25,842 P177749 INFO Evaluation @epoch 18 - batch 171: 
2024-09-23 05:45:31,094 P177749 INFO [Metrics] AUC: 0.844397 - logloss: 0.324619
2024-09-23 05:45:31,094 P177749 INFO Save best model: monitor(max)=0.844397
2024-09-23 05:45:31,156 P177749 INFO ************ Epoch=18 end ************
2024-09-23 05:46:57,055 P177749 INFO Train loss: 0.345372
2024-09-23 05:46:57,055 P177749 INFO Evaluation @epoch 19 - batch 171: 
2024-09-23 05:47:02,355 P177749 INFO [Metrics] AUC: 0.845575 - logloss: 0.323993
2024-09-23 05:47:02,356 P177749 INFO Save best model: monitor(max)=0.845575
2024-09-23 05:47:02,435 P177749 INFO ************ Epoch=19 end ************
2024-09-23 05:48:33,174 P177749 INFO Train loss: 0.344757
2024-09-23 05:48:33,175 P177749 INFO Evaluation @epoch 20 - batch 171: 
2024-09-23 05:48:38,382 P177749 INFO [Metrics] AUC: 0.844371 - logloss: 0.324707
2024-09-23 05:48:38,383 P177749 INFO Monitor(max)=0.844371 STOP!
2024-09-23 05:48:38,383 P177749 INFO Reduce learning rate on plateau: 0.000100
2024-09-23 05:48:38,457 P177749 INFO ************ Epoch=20 end ************
2024-09-23 05:50:08,866 P177749 INFO Train loss: 0.316875
2024-09-23 05:50:08,867 P177749 INFO Evaluation @epoch 21 - batch 171: 
2024-09-23 05:50:14,071 P177749 INFO [Metrics] AUC: 0.850578 - logloss: 0.321232
2024-09-23 05:50:14,071 P177749 INFO Save best model: monitor(max)=0.850578
2024-09-23 05:50:14,142 P177749 INFO ************ Epoch=21 end ************
2024-09-23 05:51:44,101 P177749 INFO Train loss: 0.305646
2024-09-23 05:51:44,101 P177749 INFO Evaluation @epoch 22 - batch 171: 
2024-09-23 05:51:48,610 P177749 INFO [Metrics] AUC: 0.852287 - logloss: 0.320778
2024-09-23 05:51:48,611 P177749 INFO Save best model: monitor(max)=0.852287
2024-09-23 05:51:48,704 P177749 INFO ************ Epoch=22 end ************
2024-09-23 05:53:17,976 P177749 INFO Train loss: 0.299861
2024-09-23 05:53:17,977 P177749 INFO Evaluation @epoch 23 - batch 171: 
2024-09-23 05:53:23,311 P177749 INFO [Metrics] AUC: 0.852675 - logloss: 0.321221
2024-09-23 05:53:23,311 P177749 INFO Save best model: monitor(max)=0.852675
2024-09-23 05:53:23,383 P177749 INFO ************ Epoch=23 end ************
2024-09-23 05:54:54,279 P177749 INFO Train loss: 0.295830
2024-09-23 05:54:54,279 P177749 INFO Evaluation @epoch 24 - batch 171: 
2024-09-23 05:54:59,559 P177749 INFO [Metrics] AUC: 0.852199 - logloss: 0.322487
2024-09-23 05:54:59,560 P177749 INFO Monitor(max)=0.852199 STOP!
2024-09-23 05:54:59,560 P177749 INFO Reduce learning rate on plateau: 0.000010
2024-09-23 05:54:59,634 P177749 INFO ************ Epoch=24 end ************
2024-09-23 05:56:30,404 P177749 INFO Train loss: 0.284547
2024-09-23 05:56:30,405 P177749 INFO Evaluation @epoch 25 - batch 171: 
2024-09-23 05:56:35,575 P177749 INFO [Metrics] AUC: 0.851973 - logloss: 0.324266
2024-09-23 05:56:35,576 P177749 INFO Monitor(max)=0.851973 STOP!
2024-09-23 05:56:35,577 P177749 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 05:56:35,577 P177749 INFO ********* Epoch=25 early stop *********
2024-09-23 05:56:35,671 P177749 INFO Training finished.
2024-09-23 05:56:35,671 P177749 INFO Load best model: /workspace/checkpoints/ML_1M_7_x1/ViTDCNv2_ML_1M_009_0fd3c701.model
