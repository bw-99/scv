2024-09-23 23:05:59,796 P441383 INFO FuxiCTR version: 2.3.2
2024-09-23 23:05:59,796 P441383 INFO Params: {
    "batch_norm": "True",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "dataset/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "deep_net_dropout": "0.2",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "layer_norm": "True",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "DCNv3",
    "model_id": "DCNv3_ML_1M_006_072c23f3",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_regularizer": "0",
    "num_deep_cross_layers": "1",
    "num_heads": "1",
    "num_shallow_cross_layers": "1",
    "num_workers": "4",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shallow_net_dropout": "0.3",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "dataset/ML_1M/test.csv",
    "train_data": "dataset/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "dataset/ML_1M/valid.csv",
    "verbose": "1"
}
2024-09-23 23:05:59,797 P441383 INFO Set up feature processor...
2024-09-23 23:05:59,798 P441383 WARNING Skip rebuilding dataset/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-09-23 23:05:59,798 P441383 INFO Load feature_map from json: dataset/ML_1M_7_x1/feature_map.json
2024-09-23 23:05:59,798 P441383 INFO Set column index...
2024-09-23 23:05:59,798 P441383 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'max_len': 5, 'vocab_size': 302}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 3659}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 83}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 6042}"
}
2024-09-23 23:06:01,070 P441383 INFO Total number of parameters: 175174.
2024-09-23 23:06:01,070 P441383 INFO Loading datasets...
2024-09-23 23:06:03,061 P441383 INFO Train samples: total/700146, blocks/1
2024-09-23 23:06:03,390 P441383 INFO Validation samples: total/200041, blocks/1
2024-09-23 23:06:03,390 P441383 INFO Loading train and validation data done.
2024-09-23 23:06:03,390 P441383 INFO Start training: 171 batches/epoch
2024-09-23 23:06:03,390 P441383 INFO ************ Epoch=1 start ************
2024-09-23 23:06:16,930 P441383 INFO Train loss: 0.454569
2024-09-23 23:06:16,930 P441383 INFO Evaluation @epoch 1 - batch 171: 
2024-09-23 23:06:18,127 P441383 INFO [Metrics] AUC: 0.798674 - logloss: 0.362130
2024-09-23 23:06:18,128 P441383 INFO Save best model: monitor(max)=0.798674
2024-09-23 23:06:18,179 P441383 INFO ************ Epoch=1 end ************
2024-09-23 23:06:30,741 P441383 INFO Train loss: 0.384069
2024-09-23 23:06:30,741 P441383 INFO Evaluation @epoch 2 - batch 171: 
2024-09-23 23:06:31,818 P441383 INFO [Metrics] AUC: 0.809971 - logloss: 0.351725
2024-09-23 23:06:31,819 P441383 INFO Save best model: monitor(max)=0.809971
2024-09-23 23:06:31,876 P441383 INFO ************ Epoch=2 end ************
2024-09-23 23:06:44,548 P441383 INFO Train loss: 0.373180
2024-09-23 23:06:44,549 P441383 INFO Evaluation @epoch 3 - batch 171: 
2024-09-23 23:06:45,834 P441383 INFO [Metrics] AUC: 0.816385 - logloss: 0.346823
2024-09-23 23:06:45,835 P441383 INFO Save best model: monitor(max)=0.816385
2024-09-23 23:06:45,909 P441383 INFO ************ Epoch=3 end ************
2024-09-23 23:06:59,236 P441383 INFO Train loss: 0.368163
2024-09-23 23:06:59,236 P441383 INFO Evaluation @epoch 4 - batch 171: 
2024-09-23 23:07:00,382 P441383 INFO [Metrics] AUC: 0.820745 - logloss: 0.343264
2024-09-23 23:07:00,383 P441383 INFO Save best model: monitor(max)=0.820745
2024-09-23 23:07:00,443 P441383 INFO ************ Epoch=4 end ************
2024-09-23 23:07:13,221 P441383 INFO Train loss: 0.364624
2024-09-23 23:07:13,221 P441383 INFO Evaluation @epoch 5 - batch 171: 
2024-09-23 23:07:14,455 P441383 INFO [Metrics] AUC: 0.823067 - logloss: 0.341278
2024-09-23 23:07:14,456 P441383 INFO Save best model: monitor(max)=0.823067
2024-09-23 23:07:14,563 P441383 INFO ************ Epoch=5 end ************
2024-09-23 23:07:27,646 P441383 INFO Train loss: 0.362748
2024-09-23 23:07:27,647 P441383 INFO Evaluation @epoch 6 - batch 171: 
2024-09-23 23:07:28,877 P441383 INFO [Metrics] AUC: 0.825205 - logloss: 0.339691
2024-09-23 23:07:28,877 P441383 INFO Save best model: monitor(max)=0.825205
2024-09-23 23:07:28,940 P441383 INFO ************ Epoch=6 end ************
2024-09-23 23:07:41,121 P441383 INFO Train loss: 0.361059
2024-09-23 23:07:41,121 P441383 INFO Evaluation @epoch 7 - batch 171: 
2024-09-23 23:07:42,307 P441383 INFO [Metrics] AUC: 0.825953 - logloss: 0.339120
2024-09-23 23:07:42,307 P441383 INFO Save best model: monitor(max)=0.825953
2024-09-23 23:07:42,371 P441383 INFO ************ Epoch=7 end ************
2024-09-23 23:07:55,274 P441383 INFO Train loss: 0.359964
2024-09-23 23:07:55,275 P441383 INFO Evaluation @epoch 8 - batch 171: 
2024-09-23 23:07:56,484 P441383 INFO [Metrics] AUC: 0.827284 - logloss: 0.337967
2024-09-23 23:07:56,485 P441383 INFO Save best model: monitor(max)=0.827284
2024-09-23 23:07:56,546 P441383 INFO ************ Epoch=8 end ************
2024-09-23 23:08:09,122 P441383 INFO Train loss: 0.359324
2024-09-23 23:08:09,123 P441383 INFO Evaluation @epoch 9 - batch 171: 
2024-09-23 23:08:10,316 P441383 INFO [Metrics] AUC: 0.829706 - logloss: 0.336019
2024-09-23 23:08:10,317 P441383 INFO Save best model: monitor(max)=0.829706
2024-09-23 23:08:10,379 P441383 INFO ************ Epoch=9 end ************
2024-09-23 23:08:22,120 P441383 INFO Train loss: 0.358458
2024-09-23 23:08:22,120 P441383 INFO Evaluation @epoch 10 - batch 171: 
2024-09-23 23:08:23,319 P441383 INFO [Metrics] AUC: 0.831237 - logloss: 0.335095
2024-09-23 23:08:23,319 P441383 INFO Save best model: monitor(max)=0.831237
2024-09-23 23:08:23,384 P441383 INFO ************ Epoch=10 end ************
2024-09-23 23:08:35,995 P441383 INFO Train loss: 0.357795
2024-09-23 23:08:35,995 P441383 INFO Evaluation @epoch 11 - batch 171: 
2024-09-23 23:08:37,199 P441383 INFO [Metrics] AUC: 0.831964 - logloss: 0.334547
2024-09-23 23:08:37,200 P441383 INFO Save best model: monitor(max)=0.831964
2024-09-23 23:08:37,261 P441383 INFO ************ Epoch=11 end ************
2024-09-23 23:08:49,608 P441383 INFO Train loss: 0.357107
2024-09-23 23:08:49,608 P441383 INFO Evaluation @epoch 12 - batch 171: 
2024-09-23 23:08:50,839 P441383 INFO [Metrics] AUC: 0.833711 - logloss: 0.333042
2024-09-23 23:08:50,840 P441383 INFO Save best model: monitor(max)=0.833711
2024-09-23 23:08:50,907 P441383 INFO ************ Epoch=12 end ************
2024-09-23 23:09:03,568 P441383 INFO Train loss: 0.356373
2024-09-23 23:09:03,569 P441383 INFO Evaluation @epoch 13 - batch 171: 
2024-09-23 23:09:04,801 P441383 INFO [Metrics] AUC: 0.834606 - logloss: 0.332156
2024-09-23 23:09:04,802 P441383 INFO Save best model: monitor(max)=0.834606
2024-09-23 23:09:04,862 P441383 INFO ************ Epoch=13 end ************
2024-09-23 23:09:17,075 P441383 INFO Train loss: 0.355832
2024-09-23 23:09:17,075 P441383 INFO Evaluation @epoch 14 - batch 171: 
2024-09-23 23:09:18,286 P441383 INFO [Metrics] AUC: 0.835507 - logloss: 0.331982
2024-09-23 23:09:18,287 P441383 INFO Save best model: monitor(max)=0.835507
2024-09-23 23:09:18,353 P441383 INFO ************ Epoch=14 end ************
2024-09-23 23:09:31,506 P441383 INFO Train loss: 0.354542
2024-09-23 23:09:31,506 P441383 INFO Evaluation @epoch 15 - batch 171: 
2024-09-23 23:09:32,752 P441383 INFO [Metrics] AUC: 0.836769 - logloss: 0.330563
2024-09-23 23:09:32,753 P441383 INFO Save best model: monitor(max)=0.836769
2024-09-23 23:09:32,816 P441383 INFO ************ Epoch=15 end ************
2024-09-23 23:09:44,925 P441383 INFO Train loss: 0.353830
2024-09-23 23:09:44,926 P441383 INFO Evaluation @epoch 16 - batch 171: 
2024-09-23 23:09:46,141 P441383 INFO [Metrics] AUC: 0.836785 - logloss: 0.330697
2024-09-23 23:09:46,142 P441383 INFO Save best model: monitor(max)=0.836785
2024-09-23 23:09:46,205 P441383 INFO ************ Epoch=16 end ************
2024-09-23 23:09:58,373 P441383 INFO Train loss: 0.353343
2024-09-23 23:09:58,374 P441383 INFO Evaluation @epoch 17 - batch 171: 
2024-09-23 23:09:59,568 P441383 INFO [Metrics] AUC: 0.839060 - logloss: 0.329027
2024-09-23 23:09:59,569 P441383 INFO Save best model: monitor(max)=0.839060
2024-09-23 23:09:59,632 P441383 INFO ************ Epoch=17 end ************
2024-09-23 23:10:12,382 P441383 INFO Train loss: 0.352440
2024-09-23 23:10:12,382 P441383 INFO Evaluation @epoch 18 - batch 171: 
2024-09-23 23:10:13,672 P441383 INFO [Metrics] AUC: 0.838614 - logloss: 0.329633
2024-09-23 23:10:13,672 P441383 INFO Monitor(max)=0.838614 STOP!
2024-09-23 23:10:13,673 P441383 INFO Reduce learning rate on plateau: 0.000100
2024-09-23 23:10:13,726 P441383 INFO ************ Epoch=18 end ************
2024-09-23 23:10:26,721 P441383 INFO Train loss: 0.332297
2024-09-23 23:10:26,721 P441383 INFO Evaluation @epoch 19 - batch 171: 
2024-09-23 23:10:27,982 P441383 INFO [Metrics] AUC: 0.846842 - logloss: 0.322434
2024-09-23 23:10:27,983 P441383 INFO Save best model: monitor(max)=0.846842
2024-09-23 23:10:28,045 P441383 INFO ************ Epoch=19 end ************
2024-09-23 23:10:41,460 P441383 INFO Train loss: 0.322904
2024-09-23 23:10:41,460 P441383 INFO Evaluation @epoch 20 - batch 171: 
2024-09-23 23:10:42,573 P441383 INFO [Metrics] AUC: 0.849614 - logloss: 0.320294
2024-09-23 23:10:42,574 P441383 INFO Save best model: monitor(max)=0.849614
2024-09-23 23:10:42,633 P441383 INFO ************ Epoch=20 end ************
2024-09-23 23:10:46,479 P441383 INFO Train loss: 0.318579
2024-09-23 23:10:46,480 P441383 INFO Evaluation @epoch 21 - batch 171: 
2024-09-23 23:10:47,326 P441383 INFO [Metrics] AUC: 0.850642 - logloss: 0.319459
2024-09-23 23:10:47,327 P441383 INFO Save best model: monitor(max)=0.850642
2024-09-23 23:10:47,388 P441383 INFO ************ Epoch=21 end ************
2024-09-23 23:10:51,860 P441383 INFO Train loss: 0.316085
2024-09-23 23:10:51,861 P441383 INFO Evaluation @epoch 22 - batch 171: 
2024-09-23 23:10:52,674 P441383 INFO [Metrics] AUC: 0.851175 - logloss: 0.319057
2024-09-23 23:10:52,674 P441383 INFO Save best model: monitor(max)=0.851175
2024-09-23 23:10:52,732 P441383 INFO ************ Epoch=22 end ************
2024-09-23 23:11:00,410 P441383 INFO Train loss: 0.314248
2024-09-23 23:11:00,410 P441383 INFO Evaluation @epoch 23 - batch 171: 
2024-09-23 23:11:01,676 P441383 INFO [Metrics] AUC: 0.851490 - logloss: 0.318945
2024-09-23 23:11:01,677 P441383 INFO Save best model: monitor(max)=0.851490
2024-09-23 23:11:01,741 P441383 INFO ************ Epoch=23 end ************
2024-09-23 23:11:14,050 P441383 INFO Train loss: 0.312500
2024-09-23 23:11:14,050 P441383 INFO Evaluation @epoch 24 - batch 171: 
2024-09-23 23:11:15,273 P441383 INFO [Metrics] AUC: 0.851648 - logloss: 0.318864
2024-09-23 23:11:15,274 P441383 INFO Save best model: monitor(max)=0.851648
2024-09-23 23:11:15,334 P441383 INFO ************ Epoch=24 end ************
2024-09-23 23:11:28,245 P441383 INFO Train loss: 0.311088
2024-09-23 23:11:28,245 P441383 INFO Evaluation @epoch 25 - batch 171: 
2024-09-23 23:11:29,471 P441383 INFO [Metrics] AUC: 0.851861 - logloss: 0.318625
2024-09-23 23:11:29,472 P441383 INFO Save best model: monitor(max)=0.851861
2024-09-23 23:11:29,535 P441383 INFO ************ Epoch=25 end ************
2024-09-23 23:11:41,307 P441383 INFO Train loss: 0.309735
2024-09-23 23:11:41,308 P441383 INFO Evaluation @epoch 26 - batch 171: 
2024-09-23 23:11:42,531 P441383 INFO [Metrics] AUC: 0.851844 - logloss: 0.318682
2024-09-23 23:11:42,532 P441383 INFO Monitor(max)=0.851844 STOP!
2024-09-23 23:11:42,532 P441383 INFO Reduce learning rate on plateau: 0.000010
2024-09-23 23:11:42,585 P441383 INFO ************ Epoch=26 end ************
2024-09-23 23:11:55,069 P441383 INFO Train loss: 0.302489
2024-09-23 23:11:55,069 P441383 INFO Evaluation @epoch 27 - batch 171: 
2024-09-23 23:11:56,305 P441383 INFO [Metrics] AUC: 0.851966 - logloss: 0.319005
2024-09-23 23:11:56,306 P441383 INFO Save best model: monitor(max)=0.851966
2024-09-23 23:11:56,367 P441383 INFO ************ Epoch=27 end ************
2024-09-23 23:12:09,068 P441383 INFO Train loss: 0.301989
2024-09-23 23:12:09,069 P441383 INFO Evaluation @epoch 28 - batch 171: 
2024-09-23 23:12:10,391 P441383 INFO [Metrics] AUC: 0.851991 - logloss: 0.319049
2024-09-23 23:12:10,392 P441383 INFO Save best model: monitor(max)=0.851991
2024-09-23 23:12:10,452 P441383 INFO ************ Epoch=28 end ************
2024-09-23 23:12:23,714 P441383 INFO Train loss: 0.301369
2024-09-23 23:12:23,714 P441383 INFO Evaluation @epoch 29 - batch 171: 
2024-09-23 23:12:24,865 P441383 INFO [Metrics] AUC: 0.852002 - logloss: 0.319135
2024-09-23 23:12:24,866 P441383 INFO Save best model: monitor(max)=0.852002
2024-09-23 23:12:24,930 P441383 INFO ************ Epoch=29 end ************
2024-09-23 23:12:38,651 P441383 INFO Train loss: 0.301240
2024-09-23 23:12:38,651 P441383 INFO Evaluation @epoch 30 - batch 171: 
2024-09-23 23:12:39,708 P441383 INFO [Metrics] AUC: 0.852033 - logloss: 0.319165
2024-09-23 23:12:39,709 P441383 INFO Save best model: monitor(max)=0.852033
2024-09-23 23:12:39,770 P441383 INFO ************ Epoch=30 end ************
2024-09-23 23:12:53,780 P441383 INFO Train loss: 0.300931
2024-09-23 23:12:53,781 P441383 INFO Evaluation @epoch 31 - batch 171: 
2024-09-23 23:12:54,651 P441383 INFO [Metrics] AUC: 0.852029 - logloss: 0.319102
2024-09-23 23:12:54,652 P441383 INFO Monitor(max)=0.852029 STOP!
2024-09-23 23:12:54,652 P441383 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 23:12:54,703 P441383 INFO ************ Epoch=31 end ************
2024-09-23 23:13:09,108 P441383 INFO Train loss: 0.299921
2024-09-23 23:13:09,108 P441383 INFO Evaluation @epoch 32 - batch 171: 
2024-09-23 23:13:09,996 P441383 INFO [Metrics] AUC: 0.852031 - logloss: 0.319130
2024-09-23 23:13:09,997 P441383 INFO Monitor(max)=0.852031 STOP!
2024-09-23 23:13:09,997 P441383 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 23:13:09,997 P441383 INFO ********* Epoch=32 early stop *********
2024-09-23 23:13:10,060 P441383 INFO Training finished.
2024-09-23 23:13:10,061 P441383 INFO Load best model: /workspace/checkpoints/ML_1M_7_x1/DCNv3_ML_1M_006_072c23f3.model
2024-09-23 23:13:10,069 P441383 INFO ****** Validation evaluation ******
2024-09-23 23:13:11,279 P441383 INFO [Metrics] logloss: 0.319165 - AUC: 0.852033
2024-09-23 23:13:11,415 P441383 INFO ******** Test evaluation ********
2024-09-23 23:13:11,415 P441383 INFO Loading datasets...
2024-09-23 23:13:11,658 P441383 INFO Test samples: total/100022, blocks/1
2024-09-23 23:13:11,659 P441383 INFO Loading test data done.
2024-09-23 23:13:12,354 P441383 INFO [Metrics] logloss: 0.317845 - AUC: 0.852162
