2024-09-23 07:30:37,510 P227253 INFO FuxiCTR version: 2.3.2
2024-09-23 07:30:37,511 P227253 INFO Params: {
    "batch_norm": "False",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "dataset/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "layer_norm": "True",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "ViTDCNv2",
    "model_id": "ViTDCNv2_ML_1M_015_df58e5c4",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_dropout": "0.1",
    "net_regularizer": "0",
    "num_cross_layers": "2",
    "num_heads": "1",
    "num_workers": "4",
    "optimizer": "adam",
    "parallel_dnn_hidden_units": "[512, 128]",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "dataset/ML_1M/test.csv",
    "train_data": "dataset/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "dataset/ML_1M/valid.csv",
    "verbose": "1",
    "vit_hidden_dim": "64",
    "vit_num_heads": "8",
    "vit_num_layers": "2",
    "vit_patch_size": "4"
}
2024-09-23 07:30:37,512 P227253 INFO Set up feature processor...
2024-09-23 07:30:37,512 P227253 WARNING Skip rebuilding dataset/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-09-23 07:30:37,512 P227253 INFO Load feature_map from json: dataset/ML_1M_7_x1/feature_map.json
2024-09-23 07:30:37,513 P227253 INFO Set column index...
2024-09-23 07:30:37,513 P227253 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'max_len': 5, 'vocab_size': 302}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 3659}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 83}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 6042}"
}
2024-09-23 07:30:38,787 P227253 INFO Total number of parameters: 1452945.
2024-09-23 07:30:38,788 P227253 INFO Loading datasets...
2024-09-23 07:30:40,909 P227253 INFO Train samples: total/700146, blocks/1
2024-09-23 07:30:41,227 P227253 INFO Validation samples: total/200041, blocks/1
2024-09-23 07:30:41,227 P227253 INFO Loading train and validation data done.
2024-09-23 07:30:41,228 P227253 INFO Start training: 171 batches/epoch
2024-09-23 07:30:41,228 P227253 INFO ************ Epoch=1 start ************
2024-09-23 07:31:52,188 P227253 INFO Train loss: 0.415787
2024-09-23 07:31:52,188 P227253 INFO Evaluation @epoch 1 - batch 171: 
2024-09-23 07:31:56,374 P227253 INFO [Metrics] AUC: 0.801283 - logloss: 0.358031
2024-09-23 07:31:56,374 P227253 INFO Save best model: monitor(max)=0.801283
2024-09-23 07:31:56,420 P227253 INFO ************ Epoch=1 end ************
2024-09-23 07:33:06,096 P227253 INFO Train loss: 0.377358
2024-09-23 07:33:06,096 P227253 INFO Evaluation @epoch 2 - batch 171: 
2024-09-23 07:33:10,533 P227253 INFO [Metrics] AUC: 0.806194 - logloss: 0.354321
2024-09-23 07:33:10,534 P227253 INFO Save best model: monitor(max)=0.806194
2024-09-23 07:33:10,623 P227253 INFO ************ Epoch=2 end ************
2024-09-23 07:34:20,477 P227253 INFO Train loss: 0.371710
2024-09-23 07:34:20,477 P227253 INFO Evaluation @epoch 3 - batch 171: 
2024-09-23 07:34:24,581 P227253 INFO [Metrics] AUC: 0.811297 - logloss: 0.350322
2024-09-23 07:34:24,582 P227253 INFO Save best model: monitor(max)=0.811297
2024-09-23 07:34:24,647 P227253 INFO ************ Epoch=3 end ************
2024-09-23 07:35:31,491 P227253 INFO Train loss: 0.366436
2024-09-23 07:35:31,492 P227253 INFO Evaluation @epoch 4 - batch 171: 
2024-09-23 07:35:35,684 P227253 INFO [Metrics] AUC: 0.818430 - logloss: 0.344546
2024-09-23 07:35:35,685 P227253 INFO Save best model: monitor(max)=0.818430
2024-09-23 07:35:35,761 P227253 INFO ************ Epoch=4 end ************
2024-09-23 07:36:45,462 P227253 INFO Train loss: 0.363667
2024-09-23 07:36:45,463 P227253 INFO Evaluation @epoch 5 - batch 171: 
2024-09-23 07:36:49,810 P227253 INFO [Metrics] AUC: 0.823149 - logloss: 0.341396
2024-09-23 07:36:49,810 P227253 INFO Save best model: monitor(max)=0.823149
2024-09-23 07:36:49,894 P227253 INFO ************ Epoch=5 end ************
2024-09-23 07:37:59,848 P227253 INFO Train loss: 0.360367
2024-09-23 07:37:59,849 P227253 INFO Evaluation @epoch 6 - batch 171: 
2024-09-23 07:38:04,113 P227253 INFO [Metrics] AUC: 0.826635 - logloss: 0.338508
2024-09-23 07:38:04,114 P227253 INFO Save best model: monitor(max)=0.826635
2024-09-23 07:38:04,186 P227253 INFO ************ Epoch=6 end ************
2024-09-23 07:39:10,873 P227253 INFO Train loss: 0.358430
2024-09-23 07:39:10,874 P227253 INFO Evaluation @epoch 7 - batch 171: 
2024-09-23 07:39:14,532 P227253 INFO [Metrics] AUC: 0.833154 - logloss: 0.334611
2024-09-23 07:39:14,533 P227253 INFO Save best model: monitor(max)=0.833154
2024-09-23 07:39:14,602 P227253 INFO ************ Epoch=7 end ************
2024-09-23 07:40:24,236 P227253 INFO Train loss: 0.355646
2024-09-23 07:40:24,237 P227253 INFO Evaluation @epoch 8 - batch 171: 
2024-09-23 07:40:28,549 P227253 INFO [Metrics] AUC: 0.834795 - logloss: 0.332473
2024-09-23 07:40:28,549 P227253 INFO Save best model: monitor(max)=0.834795
2024-09-23 07:40:28,621 P227253 INFO ************ Epoch=8 end ************
2024-09-23 07:41:37,556 P227253 INFO Train loss: 0.353060
2024-09-23 07:41:37,557 P227253 INFO Evaluation @epoch 9 - batch 171: 
2024-09-23 07:41:41,803 P227253 INFO [Metrics] AUC: 0.836289 - logloss: 0.331330
2024-09-23 07:41:41,803 P227253 INFO Save best model: monitor(max)=0.836289
2024-09-23 07:41:41,885 P227253 INFO ************ Epoch=9 end ************
2024-09-23 07:42:51,472 P227253 INFO Train loss: 0.351214
2024-09-23 07:42:51,472 P227253 INFO Evaluation @epoch 10 - batch 171: 
2024-09-23 07:42:55,960 P227253 INFO [Metrics] AUC: 0.839251 - logloss: 0.328541
2024-09-23 07:42:55,961 P227253 INFO Save best model: monitor(max)=0.839251
2024-09-23 07:42:56,050 P227253 INFO ************ Epoch=10 end ************
2024-09-23 07:44:05,077 P227253 INFO Train loss: 0.350209
2024-09-23 07:44:05,078 P227253 INFO Evaluation @epoch 11 - batch 171: 
2024-09-23 07:44:09,309 P227253 INFO [Metrics] AUC: 0.839944 - logloss: 0.328780
2024-09-23 07:44:09,310 P227253 INFO Save best model: monitor(max)=0.839944
2024-09-23 07:44:09,380 P227253 INFO ************ Epoch=11 end ************
2024-09-23 07:45:18,734 P227253 INFO Train loss: 0.349349
2024-09-23 07:45:18,734 P227253 INFO Evaluation @epoch 12 - batch 171: 
2024-09-23 07:45:23,001 P227253 INFO [Metrics] AUC: 0.842005 - logloss: 0.326990
2024-09-23 07:45:23,002 P227253 INFO Save best model: monitor(max)=0.842005
2024-09-23 07:45:23,077 P227253 INFO ************ Epoch=12 end ************
2024-09-23 07:46:32,553 P227253 INFO Train loss: 0.348117
2024-09-23 07:46:32,554 P227253 INFO Evaluation @epoch 13 - batch 171: 
2024-09-23 07:46:36,977 P227253 INFO [Metrics] AUC: 0.842242 - logloss: 0.326507
2024-09-23 07:46:36,977 P227253 INFO Save best model: monitor(max)=0.842242
2024-09-23 07:46:37,060 P227253 INFO ************ Epoch=13 end ************
2024-09-23 07:47:46,559 P227253 INFO Train loss: 0.347420
2024-09-23 07:47:46,560 P227253 INFO Evaluation @epoch 14 - batch 171: 
2024-09-23 07:47:50,916 P227253 INFO [Metrics] AUC: 0.842240 - logloss: 0.326568
2024-09-23 07:47:50,918 P227253 INFO Monitor(max)=0.842240 STOP!
2024-09-23 07:47:50,918 P227253 INFO Reduce learning rate on plateau: 0.000100
2024-09-23 07:47:51,014 P227253 INFO ************ Epoch=14 end ************
2024-09-23 07:49:00,590 P227253 INFO Train loss: 0.321280
2024-09-23 07:49:00,591 P227253 INFO Evaluation @epoch 15 - batch 171: 
2024-09-23 07:49:04,861 P227253 INFO [Metrics] AUC: 0.850052 - logloss: 0.321464
2024-09-23 07:49:04,861 P227253 INFO Save best model: monitor(max)=0.850052
2024-09-23 07:49:04,944 P227253 INFO ************ Epoch=15 end ************
2024-09-23 07:50:10,516 P227253 INFO Train loss: 0.309576
2024-09-23 07:50:10,517 P227253 INFO Evaluation @epoch 16 - batch 171: 
2024-09-23 07:50:14,775 P227253 INFO [Metrics] AUC: 0.852628 - logloss: 0.319866
2024-09-23 07:50:14,776 P227253 INFO Save best model: monitor(max)=0.852628
2024-09-23 07:50:14,845 P227253 INFO ************ Epoch=16 end ************
2024-09-23 07:51:24,480 P227253 INFO Train loss: 0.303455
2024-09-23 07:51:24,481 P227253 INFO Evaluation @epoch 17 - batch 171: 
2024-09-23 07:51:28,795 P227253 INFO [Metrics] AUC: 0.852895 - logloss: 0.320086
2024-09-23 07:51:28,795 P227253 INFO Save best model: monitor(max)=0.852895
2024-09-23 07:51:28,873 P227253 INFO ************ Epoch=17 end ************
2024-09-23 07:52:37,843 P227253 INFO Train loss: 0.299244
2024-09-23 07:52:37,844 P227253 INFO Evaluation @epoch 18 - batch 171: 
2024-09-23 07:52:42,215 P227253 INFO [Metrics] AUC: 0.852777 - logloss: 0.321558
2024-09-23 07:52:42,216 P227253 INFO Monitor(max)=0.852777 STOP!
2024-09-23 07:52:42,216 P227253 INFO Reduce learning rate on plateau: 0.000010
2024-09-23 07:52:42,289 P227253 INFO ************ Epoch=18 end ************
2024-09-23 07:53:51,312 P227253 INFO Train loss: 0.288526
2024-09-23 07:53:51,312 P227253 INFO Evaluation @epoch 19 - batch 171: 
2024-09-23 07:53:55,767 P227253 INFO [Metrics] AUC: 0.852722 - logloss: 0.323144
2024-09-23 07:53:55,768 P227253 INFO Monitor(max)=0.852722 STOP!
2024-09-23 07:53:55,768 P227253 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 07:53:55,768 P227253 INFO ********* Epoch=19 early stop *********
2024-09-23 07:53:55,848 P227253 INFO Training finished.
2024-09-23 07:53:55,848 P227253 INFO Load best model: /workspace/checkpoints/ML_1M_7_x1/ViTDCNv2_ML_1M_015_df58e5c4.model
