2024-09-23 09:36:36,389 P271531 INFO FuxiCTR version: 2.3.2
2024-09-23 09:36:36,390 P271531 INFO Params: {
    "batch_norm": "False",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "dataset/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "layer_norm": "True",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "ViTDCNv2",
    "model_id": "ViTDCNv2_ML_1M_019_51898d3e",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_dropout": "0.1",
    "net_regularizer": "0",
    "num_cross_layers": "2",
    "num_heads": "1",
    "num_workers": "4",
    "optimizer": "adam",
    "parallel_dnn_hidden_units": "[512, 128]",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "dataset/ML_1M/test.csv",
    "train_data": "dataset/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "dataset/ML_1M/valid.csv",
    "verbose": "1",
    "vit_hidden_dim": "128",
    "vit_num_heads": "2",
    "vit_num_layers": "1",
    "vit_patch_size": "4"
}
2024-09-23 09:36:36,391 P271531 INFO Set up feature processor...
2024-09-23 09:36:36,391 P271531 WARNING Skip rebuilding dataset/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-09-23 09:36:36,392 P271531 INFO Load feature_map from json: dataset/ML_1M_7_x1/feature_map.json
2024-09-23 09:36:36,392 P271531 INFO Set column index...
2024-09-23 09:36:36,392 P271531 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'max_len': 5, 'vocab_size': 302}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 3659}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 83}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 6042}"
}
2024-09-23 09:36:37,898 P271531 INFO Total number of parameters: 1531025.
2024-09-23 09:36:37,899 P271531 INFO Loading datasets...
2024-09-23 09:36:40,088 P271531 INFO Train samples: total/700146, blocks/1
2024-09-23 09:36:40,459 P271531 INFO Validation samples: total/200041, blocks/1
2024-09-23 09:36:40,459 P271531 INFO Loading train and validation data done.
2024-09-23 09:36:40,460 P271531 INFO Start training: 171 batches/epoch
2024-09-23 09:36:40,460 P271531 INFO ************ Epoch=1 start ************
2024-09-23 09:37:39,966 P271531 INFO Train loss: 0.416054
2024-09-23 09:37:39,967 P271531 INFO Evaluation @epoch 1 - batch 171: 
2024-09-23 09:37:43,805 P271531 INFO [Metrics] AUC: 0.801253 - logloss: 0.357812
2024-09-23 09:37:43,806 P271531 INFO Save best model: monitor(max)=0.801253
2024-09-23 09:37:43,866 P271531 INFO ************ Epoch=1 end ************
2024-09-23 09:38:41,495 P271531 INFO Train loss: 0.377264
2024-09-23 09:38:41,495 P271531 INFO Evaluation @epoch 2 - batch 171: 
2024-09-23 09:38:45,099 P271531 INFO [Metrics] AUC: 0.805962 - logloss: 0.354443
2024-09-23 09:38:45,099 P271531 INFO Save best model: monitor(max)=0.805962
2024-09-23 09:38:45,192 P271531 INFO ************ Epoch=2 end ************
2024-09-23 09:39:42,920 P271531 INFO Train loss: 0.371467
2024-09-23 09:39:42,920 P271531 INFO Evaluation @epoch 3 - batch 171: 
2024-09-23 09:39:46,673 P271531 INFO [Metrics] AUC: 0.812550 - logloss: 0.348807
2024-09-23 09:39:46,674 P271531 INFO Save best model: monitor(max)=0.812550
2024-09-23 09:39:46,745 P271531 INFO ************ Epoch=3 end ************
2024-09-23 09:40:43,461 P271531 INFO Train loss: 0.366550
2024-09-23 09:40:43,462 P271531 INFO Evaluation @epoch 4 - batch 171: 
2024-09-23 09:40:47,080 P271531 INFO [Metrics] AUC: 0.818738 - logloss: 0.344108
2024-09-23 09:40:47,081 P271531 INFO Save best model: monitor(max)=0.818738
2024-09-23 09:40:47,165 P271531 INFO ************ Epoch=4 end ************
2024-09-23 09:41:44,971 P271531 INFO Train loss: 0.361811
2024-09-23 09:41:44,972 P271531 INFO Evaluation @epoch 5 - batch 171: 
2024-09-23 09:41:48,565 P271531 INFO [Metrics] AUC: 0.826663 - logloss: 0.338435
2024-09-23 09:41:48,566 P271531 INFO Save best model: monitor(max)=0.826663
2024-09-23 09:41:48,662 P271531 INFO ************ Epoch=5 end ************
2024-09-23 09:42:46,487 P271531 INFO Train loss: 0.359231
2024-09-23 09:42:46,487 P271531 INFO Evaluation @epoch 6 - batch 171: 
2024-09-23 09:42:50,270 P271531 INFO [Metrics] AUC: 0.830520 - logloss: 0.335643
2024-09-23 09:42:50,271 P271531 INFO Save best model: monitor(max)=0.830520
2024-09-23 09:42:50,374 P271531 INFO ************ Epoch=6 end ************
2024-09-23 09:43:47,289 P271531 INFO Train loss: 0.356265
2024-09-23 09:43:47,289 P271531 INFO Evaluation @epoch 7 - batch 171: 
2024-09-23 09:43:50,672 P271531 INFO [Metrics] AUC: 0.833949 - logloss: 0.333005
2024-09-23 09:43:50,673 P271531 INFO Save best model: monitor(max)=0.833949
2024-09-23 09:43:50,763 P271531 INFO ************ Epoch=7 end ************
2024-09-23 09:44:47,129 P271531 INFO Train loss: 0.352975
2024-09-23 09:44:47,130 P271531 INFO Evaluation @epoch 8 - batch 171: 
2024-09-23 09:44:51,410 P271531 INFO [Metrics] AUC: 0.837220 - logloss: 0.330322
2024-09-23 09:44:51,411 P271531 INFO Save best model: monitor(max)=0.837220
2024-09-23 09:44:51,518 P271531 INFO ************ Epoch=8 end ************
2024-09-23 09:45:48,201 P271531 INFO Train loss: 0.350472
2024-09-23 09:45:48,202 P271531 INFO Evaluation @epoch 9 - batch 171: 
2024-09-23 09:45:52,109 P271531 INFO [Metrics] AUC: 0.841027 - logloss: 0.327766
2024-09-23 09:45:52,110 P271531 INFO Save best model: monitor(max)=0.841027
2024-09-23 09:45:52,207 P271531 INFO ************ Epoch=9 end ************
2024-09-23 09:46:50,357 P271531 INFO Train loss: 0.348893
2024-09-23 09:46:50,358 P271531 INFO Evaluation @epoch 10 - batch 171: 
2024-09-23 09:46:54,163 P271531 INFO [Metrics] AUC: 0.841217 - logloss: 0.327024
2024-09-23 09:46:54,163 P271531 INFO Save best model: monitor(max)=0.841217
2024-09-23 09:46:54,257 P271531 INFO ************ Epoch=10 end ************
2024-09-23 09:47:51,322 P271531 INFO Train loss: 0.347884
2024-09-23 09:47:51,322 P271531 INFO Evaluation @epoch 11 - batch 171: 
2024-09-23 09:47:54,743 P271531 INFO [Metrics] AUC: 0.841580 - logloss: 0.326904
2024-09-23 09:47:54,744 P271531 INFO Save best model: monitor(max)=0.841580
2024-09-23 09:47:54,817 P271531 INFO ************ Epoch=11 end ************
2024-09-23 09:48:49,873 P271531 INFO Train loss: 0.347120
2024-09-23 09:48:49,874 P271531 INFO Evaluation @epoch 12 - batch 171: 
2024-09-23 09:48:53,706 P271531 INFO [Metrics] AUC: 0.843305 - logloss: 0.325210
2024-09-23 09:48:53,707 P271531 INFO Save best model: monitor(max)=0.843305
2024-09-23 09:48:53,776 P271531 INFO ************ Epoch=12 end ************
2024-09-23 09:49:51,440 P271531 INFO Train loss: 0.346418
2024-09-23 09:49:51,440 P271531 INFO Evaluation @epoch 13 - batch 171: 
2024-09-23 09:49:55,313 P271531 INFO [Metrics] AUC: 0.845140 - logloss: 0.324013
2024-09-23 09:49:55,314 P271531 INFO Save best model: monitor(max)=0.845140
2024-09-23 09:49:55,411 P271531 INFO ************ Epoch=13 end ************
2024-09-23 09:50:52,488 P271531 INFO Train loss: 0.346047
2024-09-23 09:50:52,490 P271531 INFO Evaluation @epoch 14 - batch 171: 
2024-09-23 09:50:56,688 P271531 INFO [Metrics] AUC: 0.845128 - logloss: 0.324116
2024-09-23 09:50:56,689 P271531 INFO Monitor(max)=0.845128 STOP!
2024-09-23 09:50:56,689 P271531 INFO Reduce learning rate on plateau: 0.000100
2024-09-23 09:50:56,783 P271531 INFO ************ Epoch=14 end ************
2024-09-23 09:51:54,528 P271531 INFO Train loss: 0.318720
2024-09-23 09:51:54,529 P271531 INFO Evaluation @epoch 15 - batch 171: 
2024-09-23 09:51:58,270 P271531 INFO [Metrics] AUC: 0.851306 - logloss: 0.321298
2024-09-23 09:51:58,271 P271531 INFO Save best model: monitor(max)=0.851306
2024-09-23 09:51:58,338 P271531 INFO ************ Epoch=15 end ************
2024-09-23 09:52:53,184 P271531 INFO Train loss: 0.307083
2024-09-23 09:52:53,185 P271531 INFO Evaluation @epoch 16 - batch 171: 
2024-09-23 09:52:57,027 P271531 INFO [Metrics] AUC: 0.852939 - logloss: 0.320686
2024-09-23 09:52:57,028 P271531 INFO Save best model: monitor(max)=0.852939
2024-09-23 09:52:57,102 P271531 INFO ************ Epoch=16 end ************
2024-09-23 09:53:54,834 P271531 INFO Train loss: 0.300573
2024-09-23 09:53:54,834 P271531 INFO Evaluation @epoch 17 - batch 171: 
2024-09-23 09:53:58,691 P271531 INFO [Metrics] AUC: 0.853131 - logloss: 0.321476
2024-09-23 09:53:58,692 P271531 INFO Save best model: monitor(max)=0.853131
2024-09-23 09:53:58,769 P271531 INFO ************ Epoch=17 end ************
2024-09-23 09:54:57,294 P271531 INFO Train loss: 0.295901
2024-09-23 09:54:57,295 P271531 INFO Evaluation @epoch 18 - batch 171: 
2024-09-23 09:55:01,037 P271531 INFO [Metrics] AUC: 0.852361 - logloss: 0.323125
2024-09-23 09:55:01,038 P271531 INFO Monitor(max)=0.852361 STOP!
2024-09-23 09:55:01,038 P271531 INFO Reduce learning rate on plateau: 0.000010
2024-09-23 09:55:01,123 P271531 INFO ************ Epoch=18 end ************
2024-09-23 09:55:54,025 P271531 INFO Train loss: 0.283296
2024-09-23 09:55:54,025 P271531 INFO Evaluation @epoch 19 - batch 171: 
2024-09-23 09:55:57,689 P271531 INFO [Metrics] AUC: 0.852234 - logloss: 0.325796
2024-09-23 09:55:57,690 P271531 INFO Monitor(max)=0.852234 STOP!
2024-09-23 09:55:57,690 P271531 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 09:55:57,690 P271531 INFO ********* Epoch=19 early stop *********
2024-09-23 09:55:57,767 P271531 INFO Training finished.
2024-09-23 09:55:57,768 P271531 INFO Load best model: /workspace/checkpoints/ML_1M_7_x1/ViTDCNv2_ML_1M_019_51898d3e.model
