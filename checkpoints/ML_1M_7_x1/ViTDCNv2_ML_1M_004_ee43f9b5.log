2024-09-23 02:43:26,151 P122759 INFO FuxiCTR version: 2.3.2
2024-09-23 02:43:26,152 P122759 INFO Params: {
    "batch_norm": "False",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "dataset/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "layer_norm": "True",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "ViTDCNv2",
    "model_id": "ViTDCNv2_ML_1M_004_ee43f9b5",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_dropout": "0.1",
    "net_regularizer": "0",
    "num_cross_layers": "2",
    "num_heads": "1",
    "num_workers": "4",
    "optimizer": "adam",
    "parallel_dnn_hidden_units": "[512, 128]",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "dataset/ML_1M/test.csv",
    "train_data": "dataset/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "dataset/ML_1M/valid.csv",
    "verbose": "1",
    "vit_hidden_dim": "32",
    "vit_num_heads": "2",
    "vit_num_layers": "2",
    "vit_patch_size": "4"
}
2024-09-23 02:43:26,153 P122759 INFO Set up feature processor...
2024-09-23 02:43:26,153 P122759 WARNING Skip rebuilding dataset/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-09-23 02:43:26,153 P122759 INFO Load feature_map from json: dataset/ML_1M_7_x1/feature_map.json
2024-09-23 02:43:26,153 P122759 INFO Set column index...
2024-09-23 02:43:26,154 P122759 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'max_len': 5, 'vocab_size': 302}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 3659}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 83}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 6042}"
}
2024-09-23 02:43:27,467 P122759 INFO Total number of parameters: 870033.
2024-09-23 02:43:27,468 P122759 INFO Loading datasets...
2024-09-23 02:43:30,121 P122759 INFO Train samples: total/700146, blocks/1
2024-09-23 02:43:30,426 P122759 INFO Validation samples: total/200041, blocks/1
2024-09-23 02:43:30,426 P122759 INFO Loading train and validation data done.
2024-09-23 02:43:30,427 P122759 INFO Start training: 171 batches/epoch
2024-09-23 02:43:30,427 P122759 INFO ************ Epoch=1 start ************
2024-09-23 02:44:38,694 P122759 INFO Train loss: 0.417116
2024-09-23 02:44:38,695 P122759 INFO Evaluation @epoch 1 - batch 171: 
2024-09-23 02:44:42,585 P122759 INFO [Metrics] AUC: 0.799814 - logloss: 0.358622
2024-09-23 02:44:42,586 P122759 INFO Save best model: monitor(max)=0.799814
2024-09-23 02:44:42,633 P122759 INFO ************ Epoch=1 end ************
2024-09-23 02:45:49,261 P122759 INFO Train loss: 0.377797
2024-09-23 02:45:49,262 P122759 INFO Evaluation @epoch 2 - batch 171: 
2024-09-23 02:45:53,153 P122759 INFO [Metrics] AUC: 0.804003 - logloss: 0.356016
2024-09-23 02:45:53,153 P122759 INFO Save best model: monitor(max)=0.804003
2024-09-23 02:45:53,230 P122759 INFO ************ Epoch=2 end ************
2024-09-23 02:46:56,038 P122759 INFO Train loss: 0.373144
2024-09-23 02:46:56,038 P122759 INFO Evaluation @epoch 3 - batch 171: 
2024-09-23 02:46:59,981 P122759 INFO [Metrics] AUC: 0.809107 - logloss: 0.352334
2024-09-23 02:46:59,982 P122759 INFO Save best model: monitor(max)=0.809107
2024-09-23 02:47:00,063 P122759 INFO ************ Epoch=3 end ************
2024-09-23 02:48:06,980 P122759 INFO Train loss: 0.368405
2024-09-23 02:48:06,980 P122759 INFO Evaluation @epoch 4 - batch 171: 
2024-09-23 02:48:10,902 P122759 INFO [Metrics] AUC: 0.817123 - logloss: 0.345565
2024-09-23 02:48:10,903 P122759 INFO Save best model: monitor(max)=0.817123
2024-09-23 02:48:10,979 P122759 INFO ************ Epoch=4 end ************
2024-09-23 02:49:17,655 P122759 INFO Train loss: 0.363812
2024-09-23 02:49:17,656 P122759 INFO Evaluation @epoch 5 - batch 171: 
2024-09-23 02:49:21,524 P122759 INFO [Metrics] AUC: 0.821110 - logloss: 0.342410
2024-09-23 02:49:21,524 P122759 INFO Save best model: monitor(max)=0.821110
2024-09-23 02:49:21,597 P122759 INFO ************ Epoch=5 end ************
2024-09-23 02:50:29,002 P122759 INFO Train loss: 0.360484
2024-09-23 02:50:29,002 P122759 INFO Evaluation @epoch 6 - batch 171: 
2024-09-23 02:50:32,837 P122759 INFO [Metrics] AUC: 0.826970 - logloss: 0.338619
2024-09-23 02:50:32,838 P122759 INFO Save best model: monitor(max)=0.826970
2024-09-23 02:50:32,915 P122759 INFO ************ Epoch=6 end ************
2024-09-23 02:51:39,871 P122759 INFO Train loss: 0.358256
2024-09-23 02:51:39,871 P122759 INFO Evaluation @epoch 7 - batch 171: 
2024-09-23 02:51:43,792 P122759 INFO [Metrics] AUC: 0.831233 - logloss: 0.335091
2024-09-23 02:51:43,793 P122759 INFO Save best model: monitor(max)=0.831233
2024-09-23 02:51:43,871 P122759 INFO ************ Epoch=7 end ************
2024-09-23 02:52:46,945 P122759 INFO Train loss: 0.356439
2024-09-23 02:52:46,945 P122759 INFO Evaluation @epoch 8 - batch 171: 
2024-09-23 02:52:50,634 P122759 INFO [Metrics] AUC: 0.833489 - logloss: 0.333501
2024-09-23 02:52:50,636 P122759 INFO Save best model: monitor(max)=0.833489
2024-09-23 02:52:50,710 P122759 INFO ************ Epoch=8 end ************
2024-09-23 02:53:57,932 P122759 INFO Train loss: 0.354745
2024-09-23 02:53:57,933 P122759 INFO Evaluation @epoch 9 - batch 171: 
2024-09-23 02:54:01,856 P122759 INFO [Metrics] AUC: 0.835040 - logloss: 0.331969
2024-09-23 02:54:01,857 P122759 INFO Save best model: monitor(max)=0.835040
2024-09-23 02:54:01,924 P122759 INFO ************ Epoch=9 end ************
2024-09-23 02:55:06,304 P122759 INFO Train loss: 0.352908
2024-09-23 02:55:06,305 P122759 INFO Evaluation @epoch 10 - batch 171: 
2024-09-23 02:55:10,276 P122759 INFO [Metrics] AUC: 0.835987 - logloss: 0.331304
2024-09-23 02:55:10,276 P122759 INFO Save best model: monitor(max)=0.835987
2024-09-23 02:55:10,345 P122759 INFO ************ Epoch=10 end ************
2024-09-23 02:56:16,582 P122759 INFO Train loss: 0.351491
2024-09-23 02:56:16,583 P122759 INFO Evaluation @epoch 11 - batch 171: 
2024-09-23 02:56:20,471 P122759 INFO [Metrics] AUC: 0.837422 - logloss: 0.330509
2024-09-23 02:56:20,471 P122759 INFO Save best model: monitor(max)=0.837422
2024-09-23 02:56:20,542 P122759 INFO ************ Epoch=11 end ************
2024-09-23 02:57:26,719 P122759 INFO Train loss: 0.350138
2024-09-23 02:57:26,719 P122759 INFO Evaluation @epoch 12 - batch 171: 
2024-09-23 02:57:30,467 P122759 INFO [Metrics] AUC: 0.839805 - logloss: 0.328340
2024-09-23 02:57:30,467 P122759 INFO Save best model: monitor(max)=0.839805
2024-09-23 02:57:30,545 P122759 INFO ************ Epoch=12 end ************
2024-09-23 02:58:38,015 P122759 INFO Train loss: 0.348829
2024-09-23 02:58:38,015 P122759 INFO Evaluation @epoch 13 - batch 171: 
2024-09-23 02:58:41,952 P122759 INFO [Metrics] AUC: 0.840309 - logloss: 0.327925
2024-09-23 02:58:41,953 P122759 INFO Save best model: monitor(max)=0.840309
2024-09-23 02:58:42,029 P122759 INFO ************ Epoch=13 end ************
2024-09-23 02:59:48,529 P122759 INFO Train loss: 0.348399
2024-09-23 02:59:48,530 P122759 INFO Evaluation @epoch 14 - batch 171: 
2024-09-23 02:59:52,434 P122759 INFO [Metrics] AUC: 0.841256 - logloss: 0.327328
2024-09-23 02:59:52,435 P122759 INFO Save best model: monitor(max)=0.841256
2024-09-23 02:59:52,508 P122759 INFO ************ Epoch=14 end ************
2024-09-23 03:00:55,758 P122759 INFO Train loss: 0.347581
2024-09-23 03:00:55,758 P122759 INFO Evaluation @epoch 15 - batch 171: 
2024-09-23 03:00:59,733 P122759 INFO [Metrics] AUC: 0.842521 - logloss: 0.326246
2024-09-23 03:00:59,734 P122759 INFO Save best model: monitor(max)=0.842521
2024-09-23 03:00:59,812 P122759 INFO ************ Epoch=15 end ************
2024-09-23 03:02:07,233 P122759 INFO Train loss: 0.347108
2024-09-23 03:02:07,234 P122759 INFO Evaluation @epoch 16 - batch 171: 
2024-09-23 03:02:11,100 P122759 INFO [Metrics] AUC: 0.843145 - logloss: 0.325833
2024-09-23 03:02:11,101 P122759 INFO Save best model: monitor(max)=0.843145
2024-09-23 03:02:11,179 P122759 INFO ************ Epoch=16 end ************
2024-09-23 03:03:17,394 P122759 INFO Train loss: 0.346951
2024-09-23 03:03:17,394 P122759 INFO Evaluation @epoch 17 - batch 171: 
2024-09-23 03:03:21,345 P122759 INFO [Metrics] AUC: 0.843192 - logloss: 0.325984
2024-09-23 03:03:21,346 P122759 INFO Save best model: monitor(max)=0.843192
2024-09-23 03:03:21,427 P122759 INFO ************ Epoch=17 end ************
2024-09-23 03:04:28,521 P122759 INFO Train loss: 0.346516
2024-09-23 03:04:28,522 P122759 INFO Evaluation @epoch 18 - batch 171: 
2024-09-23 03:04:32,485 P122759 INFO [Metrics] AUC: 0.844161 - logloss: 0.324793
2024-09-23 03:04:32,486 P122759 INFO Save best model: monitor(max)=0.844161
2024-09-23 03:04:32,571 P122759 INFO ************ Epoch=18 end ************
2024-09-23 03:05:39,830 P122759 INFO Train loss: 0.346062
2024-09-23 03:05:39,831 P122759 INFO Evaluation @epoch 19 - batch 171: 
2024-09-23 03:05:43,809 P122759 INFO [Metrics] AUC: 0.844392 - logloss: 0.324874
2024-09-23 03:05:43,809 P122759 INFO Save best model: monitor(max)=0.844392
2024-09-23 03:05:43,897 P122759 INFO ************ Epoch=19 end ************
2024-09-23 03:06:50,889 P122759 INFO Train loss: 0.345763
2024-09-23 03:06:50,890 P122759 INFO Evaluation @epoch 20 - batch 171: 
2024-09-23 03:06:54,636 P122759 INFO [Metrics] AUC: 0.845249 - logloss: 0.323977
2024-09-23 03:06:54,637 P122759 INFO Save best model: monitor(max)=0.845249
2024-09-23 03:06:54,716 P122759 INFO ************ Epoch=20 end ************
2024-09-23 03:08:01,608 P122759 INFO Train loss: 0.345251
2024-09-23 03:08:01,609 P122759 INFO Evaluation @epoch 21 - batch 171: 
2024-09-23 03:08:05,369 P122759 INFO [Metrics] AUC: 0.845698 - logloss: 0.323547
2024-09-23 03:08:05,370 P122759 INFO Save best model: monitor(max)=0.845698
2024-09-23 03:08:05,454 P122759 INFO ************ Epoch=21 end ************
2024-09-23 03:09:12,648 P122759 INFO Train loss: 0.344769
2024-09-23 03:09:12,648 P122759 INFO Evaluation @epoch 22 - batch 171: 
2024-09-23 03:09:16,604 P122759 INFO [Metrics] AUC: 0.845502 - logloss: 0.323795
2024-09-23 03:09:16,605 P122759 INFO Monitor(max)=0.845502 STOP!
2024-09-23 03:09:16,605 P122759 INFO Reduce learning rate on plateau: 0.000100
2024-09-23 03:09:16,676 P122759 INFO ************ Epoch=22 end ************
2024-09-23 03:10:23,519 P122759 INFO Train loss: 0.316400
2024-09-23 03:10:23,520 P122759 INFO Evaluation @epoch 23 - batch 171: 
2024-09-23 03:10:27,419 P122759 INFO [Metrics] AUC: 0.851860 - logloss: 0.320374
2024-09-23 03:10:27,420 P122759 INFO Save best model: monitor(max)=0.851860
2024-09-23 03:10:27,489 P122759 INFO ************ Epoch=23 end ************
2024-09-23 03:11:34,199 P122759 INFO Train loss: 0.304380
2024-09-23 03:11:34,199 P122759 INFO Evaluation @epoch 24 - batch 171: 
2024-09-23 03:11:38,025 P122759 INFO [Metrics] AUC: 0.853783 - logloss: 0.320260
2024-09-23 03:11:38,026 P122759 INFO Save best model: monitor(max)=0.853783
2024-09-23 03:11:38,100 P122759 INFO ************ Epoch=24 end ************
2024-09-23 03:12:44,794 P122759 INFO Train loss: 0.298145
2024-09-23 03:12:44,795 P122759 INFO Evaluation @epoch 25 - batch 171: 
2024-09-23 03:12:48,658 P122759 INFO [Metrics] AUC: 0.853726 - logloss: 0.320901
2024-09-23 03:12:48,659 P122759 INFO Monitor(max)=0.853726 STOP!
2024-09-23 03:12:48,659 P122759 INFO Reduce learning rate on plateau: 0.000010
2024-09-23 03:12:48,743 P122759 INFO ************ Epoch=25 end ************
2024-09-23 03:13:56,030 P122759 INFO Train loss: 0.286482
2024-09-23 03:13:56,030 P122759 INFO Evaluation @epoch 26 - batch 171: 
2024-09-23 03:13:59,944 P122759 INFO [Metrics] AUC: 0.853572 - logloss: 0.322461
2024-09-23 03:13:59,945 P122759 INFO Monitor(max)=0.853572 STOP!
2024-09-23 03:13:59,945 P122759 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 03:13:59,945 P122759 INFO ********* Epoch=26 early stop *********
2024-09-23 03:14:00,019 P122759 INFO Training finished.
2024-09-23 03:14:00,020 P122759 INFO Load best model: /workspace/checkpoints/ML_1M_7_x1/ViTDCNv2_ML_1M_004_ee43f9b5.model
