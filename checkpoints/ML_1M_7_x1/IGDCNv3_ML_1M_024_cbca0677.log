2024-09-23 22:01:18,680 P386882 INFO FuxiCTR version: 2.3.2
2024-09-23 22:01:18,681 P386882 INFO Params: {
    "batch_norm": "True",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "dataset/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "deep_net_dropout": "0.2",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "layer_norm": "True",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "IGDCNv3",
    "model_id": "IGDCNv3_ML_1M_024_cbca0677",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_regularizer": "0",
    "num_deep_cross_layers": "1",
    "num_heads": "1",
    "num_shallow_cross_layers": "3",
    "num_workers": "4",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shallow_net_dropout": "0.3",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "dataset/ML_1M/test.csv",
    "train_data": "dataset/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "dataset/ML_1M/valid.csv",
    "verbose": "1"
}
2024-09-23 22:01:18,682 P386882 INFO Set up feature processor...
2024-09-23 22:01:18,682 P386882 WARNING Skip rebuilding dataset/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-09-23 22:01:18,682 P386882 INFO Load feature_map from json: dataset/ML_1M_7_x1/feature_map.json
2024-09-23 22:01:18,682 P386882 INFO Set column index...
2024-09-23 22:01:18,683 P386882 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'max_len': 5, 'vocab_size': 302}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 3659}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 83}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 6042}"
}
2024-09-23 22:01:19,943 P386882 INFO Total number of parameters: 188394.
2024-09-23 22:01:19,943 P386882 INFO Loading datasets...
2024-09-23 22:01:21,485 P386882 INFO Train samples: total/700146, blocks/1
2024-09-23 22:01:21,940 P386882 INFO Validation samples: total/200041, blocks/1
2024-09-23 22:01:21,941 P386882 INFO Loading train and validation data done.
2024-09-23 22:01:21,941 P386882 INFO Start training: 171 batches/epoch
2024-09-23 22:01:21,941 P386882 INFO ************ Epoch=1 start ************
2024-09-23 22:01:27,874 P386882 INFO Train loss: 0.446064
2024-09-23 22:01:27,874 P386882 INFO Evaluation @epoch 1 - batch 171: 
2024-09-23 22:01:28,612 P386882 INFO [Metrics] AUC: 0.800657 - logloss: 0.357715
2024-09-23 22:01:28,612 P386882 INFO Save best model: monitor(max)=0.800657
2024-09-23 22:01:28,657 P386882 INFO ************ Epoch=1 end ************
2024-09-23 22:01:33,445 P386882 INFO Train loss: 0.380395
2024-09-23 22:01:33,445 P386882 INFO Evaluation @epoch 2 - batch 171: 
2024-09-23 22:01:34,224 P386882 INFO [Metrics] AUC: 0.809881 - logloss: 0.351874
2024-09-23 22:01:34,224 P386882 INFO Save best model: monitor(max)=0.809881
2024-09-23 22:01:34,282 P386882 INFO ************ Epoch=2 end ************
2024-09-23 22:01:39,063 P386882 INFO Train loss: 0.371988
2024-09-23 22:01:39,063 P386882 INFO Evaluation @epoch 3 - batch 171: 
2024-09-23 22:01:39,828 P386882 INFO [Metrics] AUC: 0.812462 - logloss: 0.349607
2024-09-23 22:01:39,828 P386882 INFO Save best model: monitor(max)=0.812462
2024-09-23 22:01:39,886 P386882 INFO ************ Epoch=3 end ************
2024-09-23 22:01:44,683 P386882 INFO Train loss: 0.368964
2024-09-23 22:01:44,684 P386882 INFO Evaluation @epoch 4 - batch 171: 
2024-09-23 22:01:45,422 P386882 INFO [Metrics] AUC: 0.815699 - logloss: 0.347030
2024-09-23 22:01:45,423 P386882 INFO Save best model: monitor(max)=0.815699
2024-09-23 22:01:45,483 P386882 INFO ************ Epoch=4 end ************
2024-09-23 22:01:50,326 P386882 INFO Train loss: 0.368796
2024-09-23 22:01:50,327 P386882 INFO Evaluation @epoch 5 - batch 171: 
2024-09-23 22:01:51,106 P386882 INFO [Metrics] AUC: 0.819368 - logloss: 0.343865
2024-09-23 22:01:51,106 P386882 INFO Save best model: monitor(max)=0.819368
2024-09-23 22:01:51,166 P386882 INFO ************ Epoch=5 end ************
2024-09-23 22:01:56,013 P386882 INFO Train loss: 0.366651
2024-09-23 22:01:56,014 P386882 INFO Evaluation @epoch 6 - batch 171: 
2024-09-23 22:01:56,794 P386882 INFO [Metrics] AUC: 0.824791 - logloss: 0.340068
2024-09-23 22:01:56,795 P386882 INFO Save best model: monitor(max)=0.824791
2024-09-23 22:01:56,852 P386882 INFO ************ Epoch=6 end ************
2024-09-23 22:02:01,582 P386882 INFO Train loss: 0.364476
2024-09-23 22:02:01,582 P386882 INFO Evaluation @epoch 7 - batch 171: 
2024-09-23 22:02:02,350 P386882 INFO [Metrics] AUC: 0.827292 - logloss: 0.337963
2024-09-23 22:02:02,351 P386882 INFO Save best model: monitor(max)=0.827292
2024-09-23 22:02:02,408 P386882 INFO ************ Epoch=7 end ************
2024-09-23 22:02:07,056 P386882 INFO Train loss: 0.362065
2024-09-23 22:02:07,056 P386882 INFO Evaluation @epoch 8 - batch 171: 
2024-09-23 22:02:07,806 P386882 INFO [Metrics] AUC: 0.830265 - logloss: 0.335629
2024-09-23 22:02:07,806 P386882 INFO Save best model: monitor(max)=0.830265
2024-09-23 22:02:07,864 P386882 INFO ************ Epoch=8 end ************
2024-09-23 22:02:12,623 P386882 INFO Train loss: 0.359703
2024-09-23 22:02:12,623 P386882 INFO Evaluation @epoch 9 - batch 171: 
2024-09-23 22:02:13,362 P386882 INFO [Metrics] AUC: 0.832599 - logloss: 0.333902
2024-09-23 22:02:13,362 P386882 INFO Save best model: monitor(max)=0.832599
2024-09-23 22:02:13,421 P386882 INFO ************ Epoch=9 end ************
2024-09-23 22:02:18,240 P386882 INFO Train loss: 0.357973
2024-09-23 22:02:18,240 P386882 INFO Evaluation @epoch 10 - batch 171: 
2024-09-23 22:02:18,958 P386882 INFO [Metrics] AUC: 0.835231 - logloss: 0.332107
2024-09-23 22:02:18,959 P386882 INFO Save best model: monitor(max)=0.835231
2024-09-23 22:02:19,017 P386882 INFO ************ Epoch=10 end ************
2024-09-23 22:02:23,800 P386882 INFO Train loss: 0.356477
2024-09-23 22:02:23,801 P386882 INFO Evaluation @epoch 11 - batch 171: 
2024-09-23 22:02:24,566 P386882 INFO [Metrics] AUC: 0.835640 - logloss: 0.331549
2024-09-23 22:02:24,567 P386882 INFO Save best model: monitor(max)=0.835640
2024-09-23 22:02:24,625 P386882 INFO ************ Epoch=11 end ************
2024-09-23 22:02:29,399 P386882 INFO Train loss: 0.355520
2024-09-23 22:02:29,400 P386882 INFO Evaluation @epoch 12 - batch 171: 
2024-09-23 22:02:30,173 P386882 INFO [Metrics] AUC: 0.837272 - logloss: 0.330045
2024-09-23 22:02:30,174 P386882 INFO Save best model: monitor(max)=0.837272
2024-09-23 22:02:30,233 P386882 INFO ************ Epoch=12 end ************
2024-09-23 22:02:35,178 P386882 INFO Train loss: 0.354632
2024-09-23 22:02:35,178 P386882 INFO Evaluation @epoch 13 - batch 171: 
2024-09-23 22:02:35,943 P386882 INFO [Metrics] AUC: 0.838040 - logloss: 0.329676
2024-09-23 22:02:35,944 P386882 INFO Save best model: monitor(max)=0.838040
2024-09-23 22:02:36,002 P386882 INFO ************ Epoch=13 end ************
2024-09-23 22:02:40,756 P386882 INFO Train loss: 0.354358
2024-09-23 22:02:40,757 P386882 INFO Evaluation @epoch 14 - batch 171: 
2024-09-23 22:02:41,492 P386882 INFO [Metrics] AUC: 0.838776 - logloss: 0.329009
2024-09-23 22:02:41,493 P386882 INFO Save best model: monitor(max)=0.838776
2024-09-23 22:02:41,551 P386882 INFO ************ Epoch=14 end ************
2024-09-23 22:02:46,374 P386882 INFO Train loss: 0.353763
2024-09-23 22:02:46,375 P386882 INFO Evaluation @epoch 15 - batch 171: 
2024-09-23 22:02:47,143 P386882 INFO [Metrics] AUC: 0.839891 - logloss: 0.328509
2024-09-23 22:02:47,144 P386882 INFO Save best model: monitor(max)=0.839891
2024-09-23 22:02:47,203 P386882 INFO ************ Epoch=15 end ************
2024-09-23 22:02:52,025 P386882 INFO Train loss: 0.353455
2024-09-23 22:02:52,025 P386882 INFO Evaluation @epoch 16 - batch 171: 
2024-09-23 22:02:52,787 P386882 INFO [Metrics] AUC: 0.839717 - logloss: 0.328378
2024-09-23 22:02:52,787 P386882 INFO Monitor(max)=0.839717 STOP!
2024-09-23 22:02:52,788 P386882 INFO Reduce learning rate on plateau: 0.000100
2024-09-23 22:02:52,840 P386882 INFO ************ Epoch=16 end ************
2024-09-23 22:02:57,820 P386882 INFO Train loss: 0.330991
2024-09-23 22:02:57,820 P386882 INFO Evaluation @epoch 17 - batch 171: 
2024-09-23 22:02:58,583 P386882 INFO [Metrics] AUC: 0.848056 - logloss: 0.321342
2024-09-23 22:02:58,584 P386882 INFO Save best model: monitor(max)=0.848056
2024-09-23 22:02:58,640 P386882 INFO ************ Epoch=17 end ************
2024-09-23 22:03:03,494 P386882 INFO Train loss: 0.320141
2024-09-23 22:03:03,494 P386882 INFO Evaluation @epoch 18 - batch 171: 
2024-09-23 22:03:04,269 P386882 INFO [Metrics] AUC: 0.851311 - logloss: 0.318856
2024-09-23 22:03:04,270 P386882 INFO Save best model: monitor(max)=0.851311
2024-09-23 22:03:04,329 P386882 INFO ************ Epoch=18 end ************
2024-09-23 22:03:09,180 P386882 INFO Train loss: 0.314661
2024-09-23 22:03:09,181 P386882 INFO Evaluation @epoch 19 - batch 171: 
2024-09-23 22:03:09,956 P386882 INFO [Metrics] AUC: 0.852792 - logloss: 0.317659
2024-09-23 22:03:09,956 P386882 INFO Save best model: monitor(max)=0.852792
2024-09-23 22:03:10,016 P386882 INFO ************ Epoch=19 end ************
2024-09-23 22:03:14,935 P386882 INFO Train loss: 0.310771
2024-09-23 22:03:14,936 P386882 INFO Evaluation @epoch 20 - batch 171: 
2024-09-23 22:03:15,714 P386882 INFO [Metrics] AUC: 0.853314 - logloss: 0.317647
2024-09-23 22:03:15,715 P386882 INFO Save best model: monitor(max)=0.853314
2024-09-23 22:03:15,774 P386882 INFO ************ Epoch=20 end ************
2024-09-23 22:03:20,803 P386882 INFO Train loss: 0.307867
2024-09-23 22:03:20,803 P386882 INFO Evaluation @epoch 21 - batch 171: 
2024-09-23 22:03:21,591 P386882 INFO [Metrics] AUC: 0.853529 - logloss: 0.317666
2024-09-23 22:03:21,591 P386882 INFO Save best model: monitor(max)=0.853529
2024-09-23 22:03:21,649 P386882 INFO ************ Epoch=21 end ************
2024-09-23 22:03:26,420 P386882 INFO Train loss: 0.305720
2024-09-23 22:03:26,420 P386882 INFO Evaluation @epoch 22 - batch 171: 
2024-09-23 22:03:27,158 P386882 INFO [Metrics] AUC: 0.853628 - logloss: 0.317826
2024-09-23 22:03:27,158 P386882 INFO Save best model: monitor(max)=0.853628
2024-09-23 22:03:27,215 P386882 INFO ************ Epoch=22 end ************
2024-09-23 22:03:32,216 P386882 INFO Train loss: 0.303330
2024-09-23 22:03:32,217 P386882 INFO Evaluation @epoch 23 - batch 171: 
2024-09-23 22:03:32,991 P386882 INFO [Metrics] AUC: 0.853437 - logloss: 0.318339
2024-09-23 22:03:32,992 P386882 INFO Monitor(max)=0.853437 STOP!
2024-09-23 22:03:32,992 P386882 INFO Reduce learning rate on plateau: 0.000010
2024-09-23 22:03:33,048 P386882 INFO ************ Epoch=23 end ************
2024-09-23 22:03:37,855 P386882 INFO Train loss: 0.293143
2024-09-23 22:03:37,855 P386882 INFO Evaluation @epoch 24 - batch 171: 
2024-09-23 22:03:38,666 P386882 INFO [Metrics] AUC: 0.853279 - logloss: 0.318680
2024-09-23 22:03:38,666 P386882 INFO Monitor(max)=0.853279 STOP!
2024-09-23 22:03:38,666 P386882 INFO Reduce learning rate on plateau: 0.000001
2024-09-23 22:03:38,667 P386882 INFO ********* Epoch=24 early stop *********
2024-09-23 22:03:38,718 P386882 INFO Training finished.
2024-09-23 22:03:38,718 P386882 INFO Load best model: /workspace/checkpoints/ML_1M_7_x1/IGDCNv3_ML_1M_024_cbca0677.model
2024-09-23 22:03:38,725 P386882 INFO ****** Validation evaluation ******
2024-09-23 22:03:39,463 P386882 INFO [Metrics] logloss: 0.317826 - AUC: 0.853628
2024-09-23 22:03:39,590 P386882 INFO ******** Test evaluation ********
2024-09-23 22:03:39,590 P386882 INFO Loading datasets...
2024-09-23 22:03:39,803 P386882 INFO Test samples: total/100022, blocks/1
2024-09-23 22:03:39,804 P386882 INFO Loading test data done.
2024-09-23 22:03:40,301 P386882 INFO [Metrics] logloss: 0.316581 - AUC: 0.853432
